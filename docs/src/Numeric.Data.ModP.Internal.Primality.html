<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-identities #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-redundant-constraints #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">-- See the note on Modulus for why this warning is disabled</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">-- | Internal tools for modular arithmetic and primality testing. The main</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- functions are 'isPrime' and 'findInverse', though others are exported for</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- testing.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html"><span class="hs-identifier">Numeric.Data.ModP.Internal.Primality</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Primality Testing</span></span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MaybePrime"><span class="hs-identifier">MaybePrime</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isPrime"><span class="hs-identifier">isPrime</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isPrimeTrials"><span class="hs-identifier">isPrimeTrials</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#millerRabin"><span class="hs-identifier">millerRabin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Arithmoi vs. Default</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- $arithmoi</span></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isPrimeArithmoi"><span class="hs-identifier">isPrimeArithmoi</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isPrimeDefault"><span class="hs-identifier">isPrimeDefault</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Helper Types</span></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- $primality-helper</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Modulus"><span class="hs-identifier">Modulus</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Pow"><span class="hs-identifier">Pow</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Mult"><span class="hs-identifier">Mult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Rand"><span class="hs-identifier">Rand</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Helper Functions</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#trial"><span class="hs-identifier">trial</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isWitness"><span class="hs-identifier">isWitness</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#sqProgression"><span class="hs-identifier">sqProgression</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#factor2"><span class="hs-identifier">factor2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Multiplicative Inverses</span></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Arithmoi vs. Default</span></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#invert"><span class="hs-identifier">invert</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#invertArithmoi"><span class="hs-identifier">invertArithmoi</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#invertDefault"><span class="hs-identifier">invertDefault</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Types / Low-level</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Bezout"><span class="hs-identifier">Bezout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#R"><span class="hs-identifier">R</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#S"><span class="hs-identifier">S</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#T"><span class="hs-identifier">T</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#findInverse"><span class="hs-identifier">findInverse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#findBezout"><span class="hs-identifier">findBezout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Misc</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#errMsg"><span class="hs-identifier">errMsg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeNats</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">KnownNat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">natVal</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Natural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Natural</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/l27lrppbhrb4r31r4j7sn5z9smxv2rn3-random-1.2.1.3-doc/share/doc/random-1.2.1.3/html/src/System.Random.html/System.Random.html"><span class="hs-identifier">System.Random</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/l27lrppbhrb4r31r4j7sn5z9smxv2rn3-random-1.2.1.3-doc/share/doc/random-1.2.1.3/html/src/System.Random.Internal.html/System.Random.Internal.html#UniformRange"><span class="hs-identifier">UniformRange</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/l27lrppbhrb4r31r4j7sn5z9smxv2rn3-random-1.2.1.3-doc/share/doc/random-1.2.1.3/html/src/System.Random.html/System.Random.html"><span class="hs-identifier">System.Random</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Rand</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/l27lrppbhrb4r31r4j7sn5z9smxv2rn3-random-1.2.1.3-doc/share/doc/random-1.2.1.3/html/src/System.Random.Stateful.html/System.Random.Stateful.html"><span class="hs-identifier">System.Random.Stateful</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">RandState</span></span><span class="hs-cpp">

#if USE_ARITHMOI
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Mod</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Mod</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Mod</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Mod</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Math.NumberTheory.Primes.Testing</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">AM.Primes.Testing</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- | Result of running Miller-Rabin algorithm. At best we can determine if</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- some @n@ is definitely composite or &quot;probably prime&quot;.</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-78"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MaybePrime"><span class="hs-identifier hs-type">MaybePrime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">data</span><span> </span><span id="MaybePrime"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MaybePrime"><span class="hs-identifier hs-var">MaybePrime</span></a></span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Composite"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Composite"><span class="hs-identifier hs-var">Composite</span></a></span></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ProbablyPrime"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#ProbablyPrime"><span class="hs-identifier hs-var">ProbablyPrime</span></a></span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111304"><span id="local-6989586621679111309"><span class="annot"><span class="annottext">MaybePrime -&gt; MaybePrime -&gt; Bool
(MaybePrime -&gt; MaybePrime -&gt; Bool)
-&gt; (MaybePrime -&gt; MaybePrime -&gt; Bool) -&gt; Eq MaybePrime
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: MaybePrime -&gt; MaybePrime -&gt; Bool
== :: MaybePrime -&gt; MaybePrime -&gt; Bool
$c/= :: MaybePrime -&gt; MaybePrime -&gt; Bool
/= :: MaybePrime -&gt; MaybePrime -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111314"><span id="local-6989586621679111316"><span class="annot"><span class="annottext">(forall x. MaybePrime -&gt; Rep MaybePrime x)
-&gt; (forall x. Rep MaybePrime x -&gt; MaybePrime) -&gt; Generic MaybePrime
forall x. Rep MaybePrime x -&gt; MaybePrime
forall x. MaybePrime -&gt; Rep MaybePrime x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. MaybePrime -&gt; Rep MaybePrime x
from :: forall x. MaybePrime -&gt; Rep MaybePrime x
$cto :: forall x. Rep MaybePrime x -&gt; MaybePrime
to :: forall x. Rep MaybePrime x -&gt; MaybePrime
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111322"><span id="local-6989586621679111324"><span id="local-6989586621679111328"><span class="annot"><span class="annottext">Int -&gt; MaybePrime -&gt; ShowS
[MaybePrime] -&gt; ShowS
MaybePrime -&gt; String
(Int -&gt; MaybePrime -&gt; ShowS)
-&gt; (MaybePrime -&gt; String)
-&gt; ([MaybePrime] -&gt; ShowS)
-&gt; Show MaybePrime
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; MaybePrime -&gt; ShowS
showsPrec :: Int -&gt; MaybePrime -&gt; ShowS
$cshow :: MaybePrime -&gt; String
show :: MaybePrime -&gt; String
$cshowList :: [MaybePrime] -&gt; ShowS
showList :: [MaybePrime] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111333"><span class="annot"><span class="annottext">MaybePrime -&gt; ()
(MaybePrime -&gt; ()) -&gt; NFData MaybePrime
forall a. (a -&gt; ()) -&gt; NFData a
$crnf :: MaybePrime -&gt; ()
rnf :: MaybePrime -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679111349"><span id="local-6989586621679111353"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MaybePrime"><span class="hs-identifier hs-type">MaybePrime</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#Composite"><span class="hs-identifier hs-var">Composite</span></a></span><span> </span><span id="local-6989586621679111358"><span class="annot"><span class="annottext">&lt;&gt; :: MaybePrime -&gt; MaybePrime -&gt; MaybePrime
</span><span class="hs-operator hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><span class="annottext">MaybePrime
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#Composite"><span class="hs-identifier hs-var">Composite</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#ProbablyPrime"><span class="hs-identifier hs-var">ProbablyPrime</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span id="local-6989586621679111359"><span class="annot"><span class="annottext">MaybePrime
</span><a href="#local-6989586621679111359"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="#local-6989586621679111359"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679111364"><span id="local-6989586621679111368"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MaybePrime"><span class="hs-identifier hs-type">MaybePrime</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>  </span><span id="local-6989586621679111371"><span class="annot"><span class="annottext">mempty :: MaybePrime
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#ProbablyPrime"><span class="hs-identifier hs-var">ProbablyPrime</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- TODO: Turns out, isPrime is slow. For example, isPrime 1_000_003 takes</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- quite a long time. Basic profiling (:set +s in ghci) shows that memory</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- scales with the prime. This is probably much worse than it should be.</span><span>
</span><span id="line-95"></span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- The optional flag arithmoi enables the arithmoi package, which is much</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- faster. But it would be nice if we could improve the default as well.</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | Tests primality via the Miller-Rabin algorithm with 100 trials. Returns</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- 'Composite' if the number is definitely composite, otherwise</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- 'ProbablyPrime'.</span><span>
</span><span id="line-102"></span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- ==== __Examples__</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- &gt;&gt;&gt; isPrime 7</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- ProbablyPrime</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- &gt;&gt;&gt; isPrime 22</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- Composite</span><span>
</span><span id="line-109"></span><span class="hs-comment">--</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- &gt;&gt;&gt; isPrime 373</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- ProbablyPrime</span><span>
</span><span id="line-112"></span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-114"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isPrime"><span class="hs-identifier hs-type">isPrime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MaybePrime"><span class="hs-identifier hs-type">MaybePrime</span></a></span><span class="hs-cpp">
#if USE_ARITHMOI
</span><span class="hs-identifier">isPrime</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">isPrimeArithmoi</span><span class="hs-cpp">
#else
</span><span id="isPrime"><span class="annot"><span class="annottext">isPrime :: Integer -&gt; MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#isPrime"><span class="hs-identifier hs-var hs-var">isPrime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#isPrimeDefault"><span class="hs-identifier hs-var">isPrimeDefault</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isPrime"><span class="hs-pragma hs-type">isPrime</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- $arithmoi</span><span>
</span><span id="line-123"></span><span class="hs-comment">--</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- By default, our isPrime function implements miller-rabin directly.</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- Unfortunately, the performance scales poorly (this is an issue with our</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- implementation, not miller-rabin). Thus we provide the optional flag</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- @arithmoi@ that instead uses the arithmoi package. Arithmoi is much faster,</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- though it is not a light dependency, hence the option.</span><span>
</span><span id="line-129"></span><span class="hs-comment">--</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- In other words, the flag controls the tradeoff between isPrime speed vs.</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- dependency footprint. So why do we also provide isPrimeDefault and</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- isPrimeArithmoi? Benchmarking. We want to benchmark the difference, hence</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- we need both available when the flag is on.</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="annot"><span class="hs-comment">-- | Uses arithmoi if available, otherwise errors.</span></span><span>
</span><span id="line-136"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isPrimeArithmoi"><span class="hs-identifier hs-type">isPrimeArithmoi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MaybePrime"><span class="hs-identifier hs-type">MaybePrime</span></a></span><span class="hs-cpp">
#if USE_ARITHMOI
</span><span class="hs-identifier">isPrimeArithmoi</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">AM.Primes.Testing.isPrime</span><span> </span><span class="hs-identifier">n</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">ProbablyPrime</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">Composite</span><span class="hs-cpp">
#else
</span><span id="isPrimeArithmoi"><span class="annot"><span class="annottext">isPrimeArithmoi :: Integer -&gt; MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#isPrimeArithmoi"><span class="hs-identifier hs-var hs-var">isPrimeArithmoi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Integer -&gt; MaybePrime
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; Integer -&gt; MaybePrime)
-&gt; String -&gt; Integer -&gt; MaybePrime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Numeric.Data.ModP.Internal.Primality.html#errMsg"><span class="hs-identifier hs-var">errMsg</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arithmoi flag is disabled. Either turn the flag on or use one of isPrime, isPrimeDefault.&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-149"></span><span class="annot"><span class="hs-comment">-- | 'isPrimeTrials' with 100 trials.</span></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isPrimeDefault"><span class="hs-identifier hs-type">isPrimeDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MaybePrime"><span class="hs-identifier hs-type">MaybePrime</span></a></span><span>
</span><span id="line-151"></span><span id="isPrimeDefault"><span class="annot"><span class="annottext">isPrimeDefault :: Integer -&gt; MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#isPrimeDefault"><span class="hs-identifier hs-var hs-var">isPrimeDefault</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#isPrimeTrials"><span class="hs-identifier hs-var">isPrimeTrials</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | 'isPrime' that takes in an additional 'Int' parameter for the number</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- of trials to run. The more trials, the more confident we can be in</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- 'ProbablyPrime'.</span><span>
</span><span id="line-156"></span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- ==== __Examples__</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- &gt;&gt;&gt; isPrimeTrials 1 91</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- ProbablyPrime</span><span>
</span><span id="line-160"></span><span class="hs-comment">--</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- &gt;&gt;&gt; isPrimeTrials 2 91</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- Composite</span><span>
</span><span id="line-163"></span><span class="hs-comment">--</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- Note: False positives can be found via:</span><span>
</span><span id="line-165"></span><span class="hs-comment">--</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- -- search for \&quot;ProbablyPrime\&quot; after 1 trial in the composite sequence</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- -- for a given prime p</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- counter p = filter ((== ProbablyPrime) . snd) $</span><span>
</span><span id="line-170"></span><span class="hs-comment">--   fmap (\x -&gt; (x, isPrimeTrials 1 x)) [p + p, p + p + p ..]</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-172"></span><span class="hs-comment">--</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-174"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isPrimeTrials"><span class="hs-identifier hs-type">isPrimeTrials</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MaybePrime"><span class="hs-identifier hs-type">MaybePrime</span></a></span><span>
</span><span id="line-175"></span><span id="isPrimeTrials"><span class="annot"><span class="annottext">isPrimeTrials :: Int -&gt; Integer -&gt; MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#isPrimeTrials"><span class="hs-identifier hs-var hs-var">isPrimeTrials</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#Composite"><span class="hs-identifier hs-var">Composite</span></a></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isPrimeTrials"><span class="hs-identifier hs-var">isPrimeTrials</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#ProbablyPrime"><span class="hs-identifier hs-var">ProbablyPrime</span></a></span><span>
</span><span id="line-177"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isPrimeTrials"><span class="hs-identifier hs-var">isPrimeTrials</span></a></span><span> </span><span id="local-6989586621679111373"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111373"><span class="hs-identifier hs-var">numTrials</span></a></span></span><span> </span><span id="local-6989586621679111374"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679111374"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">even</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679111374"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#Composite"><span class="hs-identifier hs-var">Composite</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modulus -&gt; Int -&gt; MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#millerRabin"><span class="hs-identifier hs-var">millerRabin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Modulus
</span><a href="Numeric.Data.ModP.Internal.Primality.html#MkModulus"><span class="hs-identifier hs-var">MkModulus</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679111374"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111373"><span class="hs-identifier hs-var">numTrials</span></a></span><span>
</span><span id="line-180"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isPrimeTrials"><span class="hs-pragma hs-type">isPrimeTrials</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- $primality-helper</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- For the following functions/types, a core concept is rewriting our \(n\) as</span><span>
</span><span id="line-184"></span><span class="hs-comment">--</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- \[</span><span>
</span><span id="line-186"></span><span class="hs-comment">--   n = 2^r d + 1,</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-188"></span><span class="hs-comment">--</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- where \(d\) is odd i.e. we have factored out 2 as much as possible.</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- We use newtypes to track these numbers.</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | Represents a modulus. When testing for primality, this is the \(n\) in</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- \(n = 2^{r} d + 1\).</span><span>
</span><span id="line-194"></span><span class="hs-comment">--</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-196"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Modulus"><span class="hs-identifier hs-type">Modulus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-197"></span><span class="hs-keyword">newtype</span><span> </span><span id="Modulus"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Modulus"><span class="hs-identifier hs-var">Modulus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkModulus"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkModulus"><span class="hs-identifier hs-var">MkModulus</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111378"><span id="local-6989586621679111381"><span class="annot"><span class="annottext">Modulus -&gt; Modulus -&gt; Bool
(Modulus -&gt; Modulus -&gt; Bool)
-&gt; (Modulus -&gt; Modulus -&gt; Bool) -&gt; Eq Modulus
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Modulus -&gt; Modulus -&gt; Bool
== :: Modulus -&gt; Modulus -&gt; Bool
$c/= :: Modulus -&gt; Modulus -&gt; Bool
/= :: Modulus -&gt; Modulus -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111384"><span id="local-6989586621679111390"><span id="local-6989586621679111394"><span class="annot"><span class="annottext">Int -&gt; Modulus -&gt; ShowS
[Modulus] -&gt; ShowS
Modulus -&gt; String
(Int -&gt; Modulus -&gt; ShowS)
-&gt; (Modulus -&gt; String) -&gt; ([Modulus] -&gt; ShowS) -&gt; Show Modulus
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Modulus -&gt; ShowS
showsPrec :: Int -&gt; Modulus -&gt; ShowS
$cshow :: Modulus -&gt; String
show :: Modulus -&gt; String
$cshowList :: [Modulus] -&gt; ShowS
showList :: [Modulus] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111397"><span id="local-6989586621679111402"><span id="local-6989586621679111406"><span id="local-6989586621679111410"><span id="local-6989586621679111414"><span id="local-6989586621679111418"><span id="local-6989586621679111422"><span id="local-6989586621679111426"><span class="annot"><span class="annottext">Int -&gt; Modulus
Modulus -&gt; Int
Modulus -&gt; [Modulus]
Modulus -&gt; Modulus
Modulus -&gt; Modulus -&gt; [Modulus]
Modulus -&gt; Modulus -&gt; Modulus -&gt; [Modulus]
(Modulus -&gt; Modulus)
-&gt; (Modulus -&gt; Modulus)
-&gt; (Int -&gt; Modulus)
-&gt; (Modulus -&gt; Int)
-&gt; (Modulus -&gt; [Modulus])
-&gt; (Modulus -&gt; Modulus -&gt; [Modulus])
-&gt; (Modulus -&gt; Modulus -&gt; [Modulus])
-&gt; (Modulus -&gt; Modulus -&gt; Modulus -&gt; [Modulus])
-&gt; Enum Modulus
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
$csucc :: Modulus -&gt; Modulus
succ :: Modulus -&gt; Modulus
$cpred :: Modulus -&gt; Modulus
pred :: Modulus -&gt; Modulus
$ctoEnum :: Int -&gt; Modulus
toEnum :: Int -&gt; Modulus
$cfromEnum :: Modulus -&gt; Int
fromEnum :: Modulus -&gt; Int
$cenumFrom :: Modulus -&gt; [Modulus]
enumFrom :: Modulus -&gt; [Modulus]
$cenumFromThen :: Modulus -&gt; Modulus -&gt; [Modulus]
enumFromThen :: Modulus -&gt; Modulus -&gt; [Modulus]
$cenumFromTo :: Modulus -&gt; Modulus -&gt; [Modulus]
enumFromTo :: Modulus -&gt; Modulus -&gt; [Modulus]
$cenumFromThenTo :: Modulus -&gt; Modulus -&gt; Modulus -&gt; [Modulus]
enumFromThenTo :: Modulus -&gt; Modulus -&gt; Modulus -&gt; [Modulus]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111441"><span id="local-6989586621679111445"><span id="local-6989586621679111449"><span id="local-6989586621679111453"><span id="local-6989586621679111457"><span id="local-6989586621679111461"><span id="local-6989586621679111465"><span class="annot"><span class="annottext">Enum Modulus
Real Modulus
(Real Modulus, Enum Modulus) =&gt;
(Modulus -&gt; Modulus -&gt; Modulus)
-&gt; (Modulus -&gt; Modulus -&gt; Modulus)
-&gt; (Modulus -&gt; Modulus -&gt; Modulus)
-&gt; (Modulus -&gt; Modulus -&gt; Modulus)
-&gt; (Modulus -&gt; Modulus -&gt; (Modulus, Modulus))
-&gt; (Modulus -&gt; Modulus -&gt; (Modulus, Modulus))
-&gt; (Modulus -&gt; Integer)
-&gt; Integral Modulus
Modulus -&gt; Integer
Modulus -&gt; Modulus -&gt; (Modulus, Modulus)
Modulus -&gt; Modulus -&gt; Modulus
forall a.
(Real a, Enum a) =&gt;
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; Integer)
-&gt; Integral a
$cquot :: Modulus -&gt; Modulus -&gt; Modulus
quot :: Modulus -&gt; Modulus -&gt; Modulus
$crem :: Modulus -&gt; Modulus -&gt; Modulus
rem :: Modulus -&gt; Modulus -&gt; Modulus
$cdiv :: Modulus -&gt; Modulus -&gt; Modulus
div :: Modulus -&gt; Modulus -&gt; Modulus
$cmod :: Modulus -&gt; Modulus -&gt; Modulus
mod :: Modulus -&gt; Modulus -&gt; Modulus
$cquotRem :: Modulus -&gt; Modulus -&gt; (Modulus, Modulus)
quotRem :: Modulus -&gt; Modulus -&gt; (Modulus, Modulus)
$cdivMod :: Modulus -&gt; Modulus -&gt; (Modulus, Modulus)
divMod :: Modulus -&gt; Modulus -&gt; (Modulus, Modulus)
$ctoInteger :: Modulus -&gt; Integer
toInteger :: Modulus -&gt; Integer
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Integral</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111479"><span id="local-6989586621679111484"><span id="local-6989586621679111488"><span id="local-6989586621679111492"><span id="local-6989586621679111496"><span id="local-6989586621679111500"><span id="local-6989586621679111504"><span class="annot"><span class="annottext">Eq Modulus
Eq Modulus =&gt;
(Modulus -&gt; Modulus -&gt; Ordering)
-&gt; (Modulus -&gt; Modulus -&gt; Bool)
-&gt; (Modulus -&gt; Modulus -&gt; Bool)
-&gt; (Modulus -&gt; Modulus -&gt; Bool)
-&gt; (Modulus -&gt; Modulus -&gt; Bool)
-&gt; (Modulus -&gt; Modulus -&gt; Modulus)
-&gt; (Modulus -&gt; Modulus -&gt; Modulus)
-&gt; Ord Modulus
Modulus -&gt; Modulus -&gt; Bool
Modulus -&gt; Modulus -&gt; Ordering
Modulus -&gt; Modulus -&gt; Modulus
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Modulus -&gt; Modulus -&gt; Ordering
compare :: Modulus -&gt; Modulus -&gt; Ordering
$c&lt; :: Modulus -&gt; Modulus -&gt; Bool
&lt; :: Modulus -&gt; Modulus -&gt; Bool
$c&lt;= :: Modulus -&gt; Modulus -&gt; Bool
&lt;= :: Modulus -&gt; Modulus -&gt; Bool
$c&gt; :: Modulus -&gt; Modulus -&gt; Bool
&gt; :: Modulus -&gt; Modulus -&gt; Bool
$c&gt;= :: Modulus -&gt; Modulus -&gt; Bool
&gt;= :: Modulus -&gt; Modulus -&gt; Bool
$cmax :: Modulus -&gt; Modulus -&gt; Modulus
max :: Modulus -&gt; Modulus -&gt; Modulus
$cmin :: Modulus -&gt; Modulus -&gt; Modulus
min :: Modulus -&gt; Modulus -&gt; Modulus
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111516"><span id="local-6989586621679111520"><span id="local-6989586621679111524"><span id="local-6989586621679111528"><span id="local-6989586621679111532"><span id="local-6989586621679111536"><span id="local-6989586621679111540"><span class="annot"><span class="annottext">Integer -&gt; Modulus
Modulus -&gt; Modulus
Modulus -&gt; Modulus -&gt; Modulus
(Modulus -&gt; Modulus -&gt; Modulus)
-&gt; (Modulus -&gt; Modulus -&gt; Modulus)
-&gt; (Modulus -&gt; Modulus -&gt; Modulus)
-&gt; (Modulus -&gt; Modulus)
-&gt; (Modulus -&gt; Modulus)
-&gt; (Modulus -&gt; Modulus)
-&gt; (Integer -&gt; Modulus)
-&gt; Num Modulus
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: Modulus -&gt; Modulus -&gt; Modulus
+ :: Modulus -&gt; Modulus -&gt; Modulus
$c- :: Modulus -&gt; Modulus -&gt; Modulus
- :: Modulus -&gt; Modulus -&gt; Modulus
$c* :: Modulus -&gt; Modulus -&gt; Modulus
* :: Modulus -&gt; Modulus -&gt; Modulus
$cnegate :: Modulus -&gt; Modulus
negate :: Modulus -&gt; Modulus
$cabs :: Modulus -&gt; Modulus
abs :: Modulus -&gt; Modulus
$csignum :: Modulus -&gt; Modulus
signum :: Modulus -&gt; Modulus
$cfromInteger :: Integer -&gt; Modulus
fromInteger :: Integer -&gt; Modulus
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111553"><span class="annot"><span class="annottext">Num Modulus
Ord Modulus
(Num Modulus, Ord Modulus) =&gt; (Modulus -&gt; Rational) -&gt; Real Modulus
Modulus -&gt; Rational
forall a. (Num a, Ord a) =&gt; (a -&gt; Rational) -&gt; Real a
$ctoRational :: Modulus -&gt; Rational
toRational :: Modulus -&gt; Rational
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Real</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- GHC 9+ is complaining that &quot;Call of toInteger :: Integer -&gt; Integer can</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- probably be omitted&quot; when deriving Integral for all these types in this</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- module. My guess is the derived instance is generating toInteger for some</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- reason. Until we investigate further, disabling the -Widentities warning</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- is the easiest workaround.</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | The \(r\) in \(n = 2^{r} d + 1\).</span><span>
</span><span id="line-208"></span><span class="hs-comment">--</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-210"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Pow"><span class="hs-identifier hs-type">Pow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-211"></span><span class="hs-keyword">newtype</span><span> </span><span id="Pow"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Pow"><span class="hs-identifier hs-var">Pow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkPow"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkPow"><span class="hs-identifier hs-var">MkPow</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111560"><span id="local-6989586621679111563"><span class="annot"><span class="annottext">Pow -&gt; Pow -&gt; Bool
(Pow -&gt; Pow -&gt; Bool) -&gt; (Pow -&gt; Pow -&gt; Bool) -&gt; Eq Pow
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Pow -&gt; Pow -&gt; Bool
== :: Pow -&gt; Pow -&gt; Bool
$c/= :: Pow -&gt; Pow -&gt; Bool
/= :: Pow -&gt; Pow -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111567"><span id="local-6989586621679111571"><span id="local-6989586621679111575"><span class="annot"><span class="annottext">Int -&gt; Pow -&gt; ShowS
[Pow] -&gt; ShowS
Pow -&gt; String
(Int -&gt; Pow -&gt; ShowS)
-&gt; (Pow -&gt; String) -&gt; ([Pow] -&gt; ShowS) -&gt; Show Pow
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Pow -&gt; ShowS
showsPrec :: Int -&gt; Pow -&gt; ShowS
$cshow :: Pow -&gt; String
show :: Pow -&gt; String
$cshowList :: [Pow] -&gt; ShowS
showList :: [Pow] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111580"><span id="local-6989586621679111583"><span id="local-6989586621679111586"><span id="local-6989586621679111590"><span id="local-6989586621679111593"><span id="local-6989586621679111596"><span id="local-6989586621679111599"><span class="annot"><span class="annottext">Eq Pow
Eq Pow =&gt;
(Pow -&gt; Pow -&gt; Ordering)
-&gt; (Pow -&gt; Pow -&gt; Bool)
-&gt; (Pow -&gt; Pow -&gt; Bool)
-&gt; (Pow -&gt; Pow -&gt; Bool)
-&gt; (Pow -&gt; Pow -&gt; Bool)
-&gt; (Pow -&gt; Pow -&gt; Pow)
-&gt; (Pow -&gt; Pow -&gt; Pow)
-&gt; Ord Pow
Pow -&gt; Pow -&gt; Bool
Pow -&gt; Pow -&gt; Ordering
Pow -&gt; Pow -&gt; Pow
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Pow -&gt; Pow -&gt; Ordering
compare :: Pow -&gt; Pow -&gt; Ordering
$c&lt; :: Pow -&gt; Pow -&gt; Bool
&lt; :: Pow -&gt; Pow -&gt; Bool
$c&lt;= :: Pow -&gt; Pow -&gt; Bool
&lt;= :: Pow -&gt; Pow -&gt; Bool
$c&gt; :: Pow -&gt; Pow -&gt; Bool
&gt; :: Pow -&gt; Pow -&gt; Bool
$c&gt;= :: Pow -&gt; Pow -&gt; Bool
&gt;= :: Pow -&gt; Pow -&gt; Bool
$cmax :: Pow -&gt; Pow -&gt; Pow
max :: Pow -&gt; Pow -&gt; Pow
$cmin :: Pow -&gt; Pow -&gt; Pow
min :: Pow -&gt; Pow -&gt; Pow
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111602"><span id="local-6989586621679111606"><span id="local-6989586621679111610"><span id="local-6989586621679111614"><span id="local-6989586621679111618"><span id="local-6989586621679111622"><span id="local-6989586621679111626"><span id="local-6989586621679111630"><span class="annot"><span class="annottext">Int -&gt; Pow
Pow -&gt; Int
Pow -&gt; [Pow]
Pow -&gt; Pow
Pow -&gt; Pow -&gt; [Pow]
Pow -&gt; Pow -&gt; Pow -&gt; [Pow]
(Pow -&gt; Pow)
-&gt; (Pow -&gt; Pow)
-&gt; (Int -&gt; Pow)
-&gt; (Pow -&gt; Int)
-&gt; (Pow -&gt; [Pow])
-&gt; (Pow -&gt; Pow -&gt; [Pow])
-&gt; (Pow -&gt; Pow -&gt; [Pow])
-&gt; (Pow -&gt; Pow -&gt; Pow -&gt; [Pow])
-&gt; Enum Pow
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
$csucc :: Pow -&gt; Pow
succ :: Pow -&gt; Pow
$cpred :: Pow -&gt; Pow
pred :: Pow -&gt; Pow
$ctoEnum :: Int -&gt; Pow
toEnum :: Int -&gt; Pow
$cfromEnum :: Pow -&gt; Int
fromEnum :: Pow -&gt; Int
$cenumFrom :: Pow -&gt; [Pow]
enumFrom :: Pow -&gt; [Pow]
$cenumFromThen :: Pow -&gt; Pow -&gt; [Pow]
enumFromThen :: Pow -&gt; Pow -&gt; [Pow]
$cenumFromTo :: Pow -&gt; Pow -&gt; [Pow]
enumFromTo :: Pow -&gt; Pow -&gt; [Pow]
$cenumFromThenTo :: Pow -&gt; Pow -&gt; Pow -&gt; [Pow]
enumFromThenTo :: Pow -&gt; Pow -&gt; Pow -&gt; [Pow]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111640"><span id="local-6989586621679111644"><span id="local-6989586621679111648"><span id="local-6989586621679111652"><span id="local-6989586621679111656"><span id="local-6989586621679111660"><span id="local-6989586621679111664"><span class="annot"><span class="annottext">Enum Pow
Real Pow
(Real Pow, Enum Pow) =&gt;
(Pow -&gt; Pow -&gt; Pow)
-&gt; (Pow -&gt; Pow -&gt; Pow)
-&gt; (Pow -&gt; Pow -&gt; Pow)
-&gt; (Pow -&gt; Pow -&gt; Pow)
-&gt; (Pow -&gt; Pow -&gt; (Pow, Pow))
-&gt; (Pow -&gt; Pow -&gt; (Pow, Pow))
-&gt; (Pow -&gt; Integer)
-&gt; Integral Pow
Pow -&gt; Integer
Pow -&gt; Pow -&gt; (Pow, Pow)
Pow -&gt; Pow -&gt; Pow
forall a.
(Real a, Enum a) =&gt;
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; Integer)
-&gt; Integral a
$cquot :: Pow -&gt; Pow -&gt; Pow
quot :: Pow -&gt; Pow -&gt; Pow
$crem :: Pow -&gt; Pow -&gt; Pow
rem :: Pow -&gt; Pow -&gt; Pow
$cdiv :: Pow -&gt; Pow -&gt; Pow
div :: Pow -&gt; Pow -&gt; Pow
$cmod :: Pow -&gt; Pow -&gt; Pow
mod :: Pow -&gt; Pow -&gt; Pow
$cquotRem :: Pow -&gt; Pow -&gt; (Pow, Pow)
quotRem :: Pow -&gt; Pow -&gt; (Pow, Pow)
$cdivMod :: Pow -&gt; Pow -&gt; (Pow, Pow)
divMod :: Pow -&gt; Pow -&gt; (Pow, Pow)
$ctoInteger :: Pow -&gt; Integer
toInteger :: Pow -&gt; Integer
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Integral</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111668"><span id="local-6989586621679111672"><span id="local-6989586621679111676"><span id="local-6989586621679111680"><span id="local-6989586621679111684"><span id="local-6989586621679111688"><span id="local-6989586621679111692"><span class="annot"><span class="annottext">Integer -&gt; Pow
Pow -&gt; Pow
Pow -&gt; Pow -&gt; Pow
(Pow -&gt; Pow -&gt; Pow)
-&gt; (Pow -&gt; Pow -&gt; Pow)
-&gt; (Pow -&gt; Pow -&gt; Pow)
-&gt; (Pow -&gt; Pow)
-&gt; (Pow -&gt; Pow)
-&gt; (Pow -&gt; Pow)
-&gt; (Integer -&gt; Pow)
-&gt; Num Pow
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: Pow -&gt; Pow -&gt; Pow
+ :: Pow -&gt; Pow -&gt; Pow
$c- :: Pow -&gt; Pow -&gt; Pow
- :: Pow -&gt; Pow -&gt; Pow
$c* :: Pow -&gt; Pow -&gt; Pow
* :: Pow -&gt; Pow -&gt; Pow
$cnegate :: Pow -&gt; Pow
negate :: Pow -&gt; Pow
$cabs :: Pow -&gt; Pow
abs :: Pow -&gt; Pow
$csignum :: Pow -&gt; Pow
signum :: Pow -&gt; Pow
$cfromInteger :: Integer -&gt; Pow
fromInteger :: Integer -&gt; Pow
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111700"><span class="annot"><span class="annottext">Num Pow
Ord Pow
(Num Pow, Ord Pow) =&gt; (Pow -&gt; Rational) -&gt; Real Pow
Pow -&gt; Rational
forall a. (Num a, Ord a) =&gt; (a -&gt; Rational) -&gt; Real a
$ctoRational :: Pow -&gt; Rational
toRational :: Pow -&gt; Rational
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Real</span></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- | The \(d\) in \(n = 2^{r} d + 1\).</span><span>
</span><span id="line-216"></span><span class="hs-comment">--</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-218"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-219"></span><span class="hs-keyword">newtype</span><span> </span><span id="Mult"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Mult"><span class="hs-identifier hs-var">Mult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkMult"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkMult"><span class="hs-identifier hs-var">MkMult</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111705"><span id="local-6989586621679111708"><span class="annot"><span class="annottext">Mult -&gt; Mult -&gt; Bool
(Mult -&gt; Mult -&gt; Bool) -&gt; (Mult -&gt; Mult -&gt; Bool) -&gt; Eq Mult
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Mult -&gt; Mult -&gt; Bool
== :: Mult -&gt; Mult -&gt; Bool
$c/= :: Mult -&gt; Mult -&gt; Bool
/= :: Mult -&gt; Mult -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111712"><span id="local-6989586621679111716"><span id="local-6989586621679111720"><span class="annot"><span class="annottext">Int -&gt; Mult -&gt; ShowS
[Mult] -&gt; ShowS
Mult -&gt; String
(Int -&gt; Mult -&gt; ShowS)
-&gt; (Mult -&gt; String) -&gt; ([Mult] -&gt; ShowS) -&gt; Show Mult
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Mult -&gt; ShowS
showsPrec :: Int -&gt; Mult -&gt; ShowS
$cshow :: Mult -&gt; String
show :: Mult -&gt; String
$cshowList :: [Mult] -&gt; ShowS
showList :: [Mult] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111725"><span id="local-6989586621679111728"><span id="local-6989586621679111731"><span id="local-6989586621679111735"><span id="local-6989586621679111738"><span id="local-6989586621679111741"><span id="local-6989586621679111744"><span class="annot"><span class="annottext">Eq Mult
Eq Mult =&gt;
(Mult -&gt; Mult -&gt; Ordering)
-&gt; (Mult -&gt; Mult -&gt; Bool)
-&gt; (Mult -&gt; Mult -&gt; Bool)
-&gt; (Mult -&gt; Mult -&gt; Bool)
-&gt; (Mult -&gt; Mult -&gt; Bool)
-&gt; (Mult -&gt; Mult -&gt; Mult)
-&gt; (Mult -&gt; Mult -&gt; Mult)
-&gt; Ord Mult
Mult -&gt; Mult -&gt; Bool
Mult -&gt; Mult -&gt; Ordering
Mult -&gt; Mult -&gt; Mult
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Mult -&gt; Mult -&gt; Ordering
compare :: Mult -&gt; Mult -&gt; Ordering
$c&lt; :: Mult -&gt; Mult -&gt; Bool
&lt; :: Mult -&gt; Mult -&gt; Bool
$c&lt;= :: Mult -&gt; Mult -&gt; Bool
&lt;= :: Mult -&gt; Mult -&gt; Bool
$c&gt; :: Mult -&gt; Mult -&gt; Bool
&gt; :: Mult -&gt; Mult -&gt; Bool
$c&gt;= :: Mult -&gt; Mult -&gt; Bool
&gt;= :: Mult -&gt; Mult -&gt; Bool
$cmax :: Mult -&gt; Mult -&gt; Mult
max :: Mult -&gt; Mult -&gt; Mult
$cmin :: Mult -&gt; Mult -&gt; Mult
min :: Mult -&gt; Mult -&gt; Mult
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111747"><span id="local-6989586621679111751"><span id="local-6989586621679111755"><span id="local-6989586621679111759"><span id="local-6989586621679111763"><span id="local-6989586621679111767"><span id="local-6989586621679111771"><span id="local-6989586621679111775"><span class="annot"><span class="annottext">Int -&gt; Mult
Mult -&gt; Int
Mult -&gt; [Mult]
Mult -&gt; Mult
Mult -&gt; Mult -&gt; [Mult]
Mult -&gt; Mult -&gt; Mult -&gt; [Mult]
(Mult -&gt; Mult)
-&gt; (Mult -&gt; Mult)
-&gt; (Int -&gt; Mult)
-&gt; (Mult -&gt; Int)
-&gt; (Mult -&gt; [Mult])
-&gt; (Mult -&gt; Mult -&gt; [Mult])
-&gt; (Mult -&gt; Mult -&gt; [Mult])
-&gt; (Mult -&gt; Mult -&gt; Mult -&gt; [Mult])
-&gt; Enum Mult
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
$csucc :: Mult -&gt; Mult
succ :: Mult -&gt; Mult
$cpred :: Mult -&gt; Mult
pred :: Mult -&gt; Mult
$ctoEnum :: Int -&gt; Mult
toEnum :: Int -&gt; Mult
$cfromEnum :: Mult -&gt; Int
fromEnum :: Mult -&gt; Int
$cenumFrom :: Mult -&gt; [Mult]
enumFrom :: Mult -&gt; [Mult]
$cenumFromThen :: Mult -&gt; Mult -&gt; [Mult]
enumFromThen :: Mult -&gt; Mult -&gt; [Mult]
$cenumFromTo :: Mult -&gt; Mult -&gt; [Mult]
enumFromTo :: Mult -&gt; Mult -&gt; [Mult]
$cenumFromThenTo :: Mult -&gt; Mult -&gt; Mult -&gt; [Mult]
enumFromThenTo :: Mult -&gt; Mult -&gt; Mult -&gt; [Mult]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111785"><span id="local-6989586621679111789"><span id="local-6989586621679111793"><span id="local-6989586621679111797"><span id="local-6989586621679111801"><span id="local-6989586621679111805"><span id="local-6989586621679111809"><span class="annot"><span class="annottext">Enum Mult
Real Mult
(Real Mult, Enum Mult) =&gt;
(Mult -&gt; Mult -&gt; Mult)
-&gt; (Mult -&gt; Mult -&gt; Mult)
-&gt; (Mult -&gt; Mult -&gt; Mult)
-&gt; (Mult -&gt; Mult -&gt; Mult)
-&gt; (Mult -&gt; Mult -&gt; (Mult, Mult))
-&gt; (Mult -&gt; Mult -&gt; (Mult, Mult))
-&gt; (Mult -&gt; Integer)
-&gt; Integral Mult
Mult -&gt; Integer
Mult -&gt; Mult -&gt; (Mult, Mult)
Mult -&gt; Mult -&gt; Mult
forall a.
(Real a, Enum a) =&gt;
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; Integer)
-&gt; Integral a
$cquot :: Mult -&gt; Mult -&gt; Mult
quot :: Mult -&gt; Mult -&gt; Mult
$crem :: Mult -&gt; Mult -&gt; Mult
rem :: Mult -&gt; Mult -&gt; Mult
$cdiv :: Mult -&gt; Mult -&gt; Mult
div :: Mult -&gt; Mult -&gt; Mult
$cmod :: Mult -&gt; Mult -&gt; Mult
mod :: Mult -&gt; Mult -&gt; Mult
$cquotRem :: Mult -&gt; Mult -&gt; (Mult, Mult)
quotRem :: Mult -&gt; Mult -&gt; (Mult, Mult)
$cdivMod :: Mult -&gt; Mult -&gt; (Mult, Mult)
divMod :: Mult -&gt; Mult -&gt; (Mult, Mult)
$ctoInteger :: Mult -&gt; Integer
toInteger :: Mult -&gt; Integer
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Integral</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111813"><span id="local-6989586621679111817"><span id="local-6989586621679111821"><span id="local-6989586621679111825"><span id="local-6989586621679111829"><span id="local-6989586621679111833"><span id="local-6989586621679111837"><span class="annot"><span class="annottext">Integer -&gt; Mult
Mult -&gt; Mult
Mult -&gt; Mult -&gt; Mult
(Mult -&gt; Mult -&gt; Mult)
-&gt; (Mult -&gt; Mult -&gt; Mult)
-&gt; (Mult -&gt; Mult -&gt; Mult)
-&gt; (Mult -&gt; Mult)
-&gt; (Mult -&gt; Mult)
-&gt; (Mult -&gt; Mult)
-&gt; (Integer -&gt; Mult)
-&gt; Num Mult
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: Mult -&gt; Mult -&gt; Mult
+ :: Mult -&gt; Mult -&gt; Mult
$c- :: Mult -&gt; Mult -&gt; Mult
- :: Mult -&gt; Mult -&gt; Mult
$c* :: Mult -&gt; Mult -&gt; Mult
* :: Mult -&gt; Mult -&gt; Mult
$cnegate :: Mult -&gt; Mult
negate :: Mult -&gt; Mult
$cabs :: Mult -&gt; Mult
abs :: Mult -&gt; Mult
$csignum :: Mult -&gt; Mult
signum :: Mult -&gt; Mult
$cfromInteger :: Integer -&gt; Mult
fromInteger :: Integer -&gt; Mult
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111846"><span class="annot"><span class="annottext">Num Mult
Ord Mult
(Num Mult, Ord Mult) =&gt; (Mult -&gt; Rational) -&gt; Real Mult
Mult -&gt; Rational
forall a. (Num a, Ord a) =&gt; (a -&gt; Rational) -&gt; Real a
$ctoRational :: Mult -&gt; Rational
toRational :: Mult -&gt; Rational
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Real</span></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | Randomly generated \(m \in [2, n - 2] \) for testing \(n\)'s primality.</span><span>
</span><span id="line-224"></span><span class="hs-comment">--</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-226"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-227"></span><span class="hs-keyword">newtype</span><span> </span><span id="Rand"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Rand"><span class="hs-identifier hs-var">Rand</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkRand"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkRand"><span class="hs-identifier hs-var">MkRand</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111851"><span id="local-6989586621679111854"><span class="annot"><span class="annottext">Rand -&gt; Rand -&gt; Bool
(Rand -&gt; Rand -&gt; Bool) -&gt; (Rand -&gt; Rand -&gt; Bool) -&gt; Eq Rand
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Rand -&gt; Rand -&gt; Bool
== :: Rand -&gt; Rand -&gt; Bool
$c/= :: Rand -&gt; Rand -&gt; Bool
/= :: Rand -&gt; Rand -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111858"><span id="local-6989586621679111862"><span id="local-6989586621679111866"><span class="annot"><span class="annottext">Int -&gt; Rand -&gt; ShowS
[Rand] -&gt; ShowS
Rand -&gt; String
(Int -&gt; Rand -&gt; ShowS)
-&gt; (Rand -&gt; String) -&gt; ([Rand] -&gt; ShowS) -&gt; Show Rand
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Rand -&gt; ShowS
showsPrec :: Int -&gt; Rand -&gt; ShowS
$cshow :: Rand -&gt; String
show :: Rand -&gt; String
$cshowList :: [Rand] -&gt; ShowS
showList :: [Rand] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111871"><span id="local-6989586621679111874"><span id="local-6989586621679111877"><span id="local-6989586621679111881"><span id="local-6989586621679111884"><span id="local-6989586621679111887"><span id="local-6989586621679111890"><span class="annot"><span class="annottext">Eq Rand
Eq Rand =&gt;
(Rand -&gt; Rand -&gt; Ordering)
-&gt; (Rand -&gt; Rand -&gt; Bool)
-&gt; (Rand -&gt; Rand -&gt; Bool)
-&gt; (Rand -&gt; Rand -&gt; Bool)
-&gt; (Rand -&gt; Rand -&gt; Bool)
-&gt; (Rand -&gt; Rand -&gt; Rand)
-&gt; (Rand -&gt; Rand -&gt; Rand)
-&gt; Ord Rand
Rand -&gt; Rand -&gt; Bool
Rand -&gt; Rand -&gt; Ordering
Rand -&gt; Rand -&gt; Rand
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Rand -&gt; Rand -&gt; Ordering
compare :: Rand -&gt; Rand -&gt; Ordering
$c&lt; :: Rand -&gt; Rand -&gt; Bool
&lt; :: Rand -&gt; Rand -&gt; Bool
$c&lt;= :: Rand -&gt; Rand -&gt; Bool
&lt;= :: Rand -&gt; Rand -&gt; Bool
$c&gt; :: Rand -&gt; Rand -&gt; Bool
&gt; :: Rand -&gt; Rand -&gt; Bool
$c&gt;= :: Rand -&gt; Rand -&gt; Bool
&gt;= :: Rand -&gt; Rand -&gt; Bool
$cmax :: Rand -&gt; Rand -&gt; Rand
max :: Rand -&gt; Rand -&gt; Rand
$cmin :: Rand -&gt; Rand -&gt; Rand
min :: Rand -&gt; Rand -&gt; Rand
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111893"><span id="local-6989586621679111897"><span id="local-6989586621679111901"><span id="local-6989586621679111905"><span id="local-6989586621679111909"><span id="local-6989586621679111913"><span id="local-6989586621679111917"><span id="local-6989586621679111921"><span class="annot"><span class="annottext">Int -&gt; Rand
Rand -&gt; Int
Rand -&gt; [Rand]
Rand -&gt; Rand
Rand -&gt; Rand -&gt; [Rand]
Rand -&gt; Rand -&gt; Rand -&gt; [Rand]
(Rand -&gt; Rand)
-&gt; (Rand -&gt; Rand)
-&gt; (Int -&gt; Rand)
-&gt; (Rand -&gt; Int)
-&gt; (Rand -&gt; [Rand])
-&gt; (Rand -&gt; Rand -&gt; [Rand])
-&gt; (Rand -&gt; Rand -&gt; [Rand])
-&gt; (Rand -&gt; Rand -&gt; Rand -&gt; [Rand])
-&gt; Enum Rand
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
$csucc :: Rand -&gt; Rand
succ :: Rand -&gt; Rand
$cpred :: Rand -&gt; Rand
pred :: Rand -&gt; Rand
$ctoEnum :: Int -&gt; Rand
toEnum :: Int -&gt; Rand
$cfromEnum :: Rand -&gt; Int
fromEnum :: Rand -&gt; Int
$cenumFrom :: Rand -&gt; [Rand]
enumFrom :: Rand -&gt; [Rand]
$cenumFromThen :: Rand -&gt; Rand -&gt; [Rand]
enumFromThen :: Rand -&gt; Rand -&gt; [Rand]
$cenumFromTo :: Rand -&gt; Rand -&gt; [Rand]
enumFromTo :: Rand -&gt; Rand -&gt; [Rand]
$cenumFromThenTo :: Rand -&gt; Rand -&gt; Rand -&gt; [Rand]
enumFromThenTo :: Rand -&gt; Rand -&gt; Rand -&gt; [Rand]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111931"><span id="local-6989586621679111935"><span id="local-6989586621679111939"><span id="local-6989586621679111943"><span id="local-6989586621679111947"><span id="local-6989586621679111951"><span id="local-6989586621679111955"><span class="annot"><span class="annottext">Enum Rand
Real Rand
(Real Rand, Enum Rand) =&gt;
(Rand -&gt; Rand -&gt; Rand)
-&gt; (Rand -&gt; Rand -&gt; Rand)
-&gt; (Rand -&gt; Rand -&gt; Rand)
-&gt; (Rand -&gt; Rand -&gt; Rand)
-&gt; (Rand -&gt; Rand -&gt; (Rand, Rand))
-&gt; (Rand -&gt; Rand -&gt; (Rand, Rand))
-&gt; (Rand -&gt; Integer)
-&gt; Integral Rand
Rand -&gt; Integer
Rand -&gt; Rand -&gt; (Rand, Rand)
Rand -&gt; Rand -&gt; Rand
forall a.
(Real a, Enum a) =&gt;
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; Integer)
-&gt; Integral a
$cquot :: Rand -&gt; Rand -&gt; Rand
quot :: Rand -&gt; Rand -&gt; Rand
$crem :: Rand -&gt; Rand -&gt; Rand
rem :: Rand -&gt; Rand -&gt; Rand
$cdiv :: Rand -&gt; Rand -&gt; Rand
div :: Rand -&gt; Rand -&gt; Rand
$cmod :: Rand -&gt; Rand -&gt; Rand
mod :: Rand -&gt; Rand -&gt; Rand
$cquotRem :: Rand -&gt; Rand -&gt; (Rand, Rand)
quotRem :: Rand -&gt; Rand -&gt; (Rand, Rand)
$cdivMod :: Rand -&gt; Rand -&gt; (Rand, Rand)
divMod :: Rand -&gt; Rand -&gt; (Rand, Rand)
$ctoInteger :: Rand -&gt; Integer
toInteger :: Rand -&gt; Integer
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Integral</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111960"><span id="local-6989586621679111964"><span id="local-6989586621679111968"><span id="local-6989586621679111972"><span id="local-6989586621679111976"><span id="local-6989586621679111980"><span id="local-6989586621679111984"><span class="annot"><span class="annottext">Integer -&gt; Rand
Rand -&gt; Rand
Rand -&gt; Rand -&gt; Rand
(Rand -&gt; Rand -&gt; Rand)
-&gt; (Rand -&gt; Rand -&gt; Rand)
-&gt; (Rand -&gt; Rand -&gt; Rand)
-&gt; (Rand -&gt; Rand)
-&gt; (Rand -&gt; Rand)
-&gt; (Rand -&gt; Rand)
-&gt; (Integer -&gt; Rand)
-&gt; Num Rand
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: Rand -&gt; Rand -&gt; Rand
+ :: Rand -&gt; Rand -&gt; Rand
$c- :: Rand -&gt; Rand -&gt; Rand
- :: Rand -&gt; Rand -&gt; Rand
$c* :: Rand -&gt; Rand -&gt; Rand
* :: Rand -&gt; Rand -&gt; Rand
$cnegate :: Rand -&gt; Rand
negate :: Rand -&gt; Rand
$cabs :: Rand -&gt; Rand
abs :: Rand -&gt; Rand
$csignum :: Rand -&gt; Rand
signum :: Rand -&gt; Rand
$cfromInteger :: Integer -&gt; Rand
fromInteger :: Integer -&gt; Rand
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679111992"><span class="annot"><span class="annottext">Num Rand
Ord Rand
(Num Rand, Ord Rand) =&gt; (Rand -&gt; Rational) -&gt; Real Rand
Rand -&gt; Rational
forall a. (Num a, Ord a) =&gt; (a -&gt; Rational) -&gt; Real a
$ctoRational :: Rand -&gt; Rational
toRational :: Rand -&gt; Rational
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Real</span></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="annot"><span class="hs-comment">-- | @since 0.1</span></span><span>
</span><span id="line-232"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="file:///nix/store/l27lrppbhrb4r31r4j7sn5z9smxv2rn3-random-1.2.1.3-doc/share/doc/random-1.2.1.3/html/src/System.Random.Internal.html/System.Random.Internal.html#UniformRange"><span class="hs-identifier hs-type">UniformRange</span></a></span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621679112008"><span class="annot"><span class="annottext">uniformRM :: forall g (m :: Type -&gt; Type).
StatefulGen g m =&gt;
(Rand, Rand) -&gt; g -&gt; m Rand
</span><a href="#local-6989586621679112008"><span class="hs-identifier hs-var hs-var hs-var">uniformRM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkRand"><span class="hs-identifier hs-type">MkRand</span></a></span><span> </span><span id="local-6989586621679112010"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112010"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkRand"><span class="hs-identifier hs-type">MkRand</span></a></span><span> </span><span id="local-6989586621679112011"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112011"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Rand) -&gt; m Integer -&gt; m Rand
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Rand
</span><a href="Numeric.Data.ModP.Internal.Primality.html#MkRand"><span class="hs-identifier hs-var">MkRand</span></a></span><span> </span><span class="annot"><span class="annottext">(m Integer -&gt; m Rand) -&gt; (g -&gt; m Integer) -&gt; g -&gt; m Rand
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; g -&gt; m Integer
forall a g (m :: Type -&gt; Type).
(UniformRange a, StatefulGen g m) =&gt;
(a, a) -&gt; g -&gt; m a
forall g (m :: Type -&gt; Type).
StatefulGen g m =&gt;
(Integer, Integer) -&gt; g -&gt; m Integer
</span><a href="file:///nix/store/l27lrppbhrb4r31r4j7sn5z9smxv2rn3-random-1.2.1.3-doc/share/doc/random-1.2.1.3/html/src/System.Random.Internal.html/System.Random.Internal.html#uniformRM"><span class="hs-identifier hs-var">RandState.uniformRM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112010"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112011"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="file:///nix/store/l27lrppbhrb4r31r4j7sn5z9smxv2rn3-random-1.2.1.3-doc/share/doc/random-1.2.1.3/html/src/System.Random.Internal.html/System.Random.Internal.html#uniformRM"><span class="hs-pragma hs-type">uniformRM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">-- | Miller-Rabin algorithm. Takes in the \(n\) to be tested and the number</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- of trials to perform. The higher the trials, the higher our confidence</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- in 'ProbablyPrime'.</span><span>
</span><span id="line-239"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#millerRabin"><span class="hs-identifier hs-type">millerRabin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Modulus"><span class="hs-identifier hs-type">Modulus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MaybePrime"><span class="hs-identifier hs-type">MaybePrime</span></a></span><span>
</span><span id="line-240"></span><span id="millerRabin"><span class="annot"><span class="annottext">millerRabin :: Modulus -&gt; Int -&gt; MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#millerRabin"><span class="hs-identifier hs-var hs-var">millerRabin</span></a></span></span><span> </span><span class="annot"><span class="annottext">Modulus
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybePrime -&gt; Int -&gt; MaybePrime
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#ProbablyPrime"><span class="hs-identifier hs-var">ProbablyPrime</span></a></span><span>
</span><span id="line-241"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#millerRabin"><span class="hs-identifier hs-var">millerRabin</span></a></span><span> </span><span id="local-6989586621679112014"><span class="annot"><span class="annottext">modulus :: Modulus
</span><a href="#local-6989586621679112014"><span class="hs-identifier hs-var">modulus</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkModulus"><span class="hs-identifier hs-type">MkModulus</span></a></span><span> </span><span id="local-6989586621679112015"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112015"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdGen -&gt; Int -&gt; MaybePrime
</span><a href="#local-6989586621679112016"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679112017"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621679112017"><span class="annot"><span class="annottext">gen :: StdGen
</span><a href="#local-6989586621679112017"><span class="hs-identifier hs-var hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StdGen
</span><a href="file:///nix/store/l27lrppbhrb4r31r4j7sn5z9smxv2rn3-random-1.2.1.3-doc/share/doc/random-1.2.1.3/html/src/System.Random.Internal.html/System.Random.Internal.html#mkStdGen"><span class="hs-identifier hs-var">Rand.mkStdGen</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">373</span></span><span>
</span><span id="line-244"></span><span>    </span><span id="local-6989586621679112019"><span class="annot"><span class="annottext">powMult :: (Pow, Mult)
</span><a href="#local-6989586621679112019"><span class="hs-identifier hs-var hs-var">powMult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modulus -&gt; (Pow, Mult)
</span><a href="Numeric.Data.ModP.Internal.Primality.html#factor2"><span class="hs-identifier hs-var">factor2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulus
</span><a href="#local-6989586621679112014"><span class="hs-identifier hs-var">modulus</span></a></span><span> </span><span class="annot"><span class="annottext">Modulus -&gt; Modulus -&gt; Modulus
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Modulus
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>    </span><span id="local-6989586621679112020"><span class="annot"><span class="annottext">range :: StateGenM StdGen -&gt; StateT StdGen Identity Rand
</span><a href="#local-6989586621679112020"><span class="hs-identifier hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Rand, Rand) -&gt; StateGenM StdGen -&gt; StateT StdGen Identity Rand
forall a g (m :: Type -&gt; Type).
(UniformRange a, StatefulGen g m) =&gt;
(a, a) -&gt; g -&gt; m a
forall g (m :: Type -&gt; Type).
StatefulGen g m =&gt;
(Rand, Rand) -&gt; g -&gt; m Rand
</span><a href="file:///nix/store/l27lrppbhrb4r31r4j7sn5z9smxv2rn3-random-1.2.1.3-doc/share/doc/random-1.2.1.3/html/src/System.Random.Internal.html/System.Random.Internal.html#uniformRM"><span class="hs-identifier hs-var">RandState.uniformRM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rand
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Rand
</span><a href="Numeric.Data.ModP.Internal.Primality.html#MkRand"><span class="hs-identifier hs-var">MkRand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112015"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>    </span><span id="local-6989586621679112016"><span class="annot"><span class="annottext">go :: StdGen -&gt; Int -&gt; MaybePrime
</span><a href="#local-6989586621679112016"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#ProbablyPrime"><span class="hs-identifier hs-var">ProbablyPrime</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><a href="#local-6989586621679112016"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679112021"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679112021"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679112022"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112022"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112023"><span class="annot"><span class="annottext">Rand
</span><a href="#local-6989586621679112023"><span class="hs-identifier hs-var">randomVal</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112024"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679112024"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdGen
-&gt; (StateGenM StdGen -&gt; StateT StdGen Identity Rand)
-&gt; (Rand, StdGen)
forall g a.
RandomGen g =&gt;
g -&gt; (StateGenM g -&gt; State g a) -&gt; (a, g)
</span><a href="file:///nix/store/l27lrppbhrb4r31r4j7sn5z9smxv2rn3-random-1.2.1.3-doc/share/doc/random-1.2.1.3/html/src/System.Random.Internal.html/System.Random.Internal.html#runStateGen"><span class="hs-identifier hs-var">RandState.runStateGen</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679112021"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">StateGenM StdGen -&gt; StateT StdGen Identity Rand
</span><a href="#local-6989586621679112020"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-250"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Modulus -&gt; (Pow, Mult) -&gt; Rand -&gt; MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#trial"><span class="hs-identifier hs-var">trial</span></a></span><span> </span><span class="annot"><span class="annottext">Modulus
</span><a href="#local-6989586621679112014"><span class="hs-identifier hs-var">modulus</span></a></span><span> </span><span class="annot"><span class="annottext">(Pow, Mult)
</span><a href="#local-6989586621679112019"><span class="hs-identifier hs-var">powMult</span></a></span><span> </span><span class="annot"><span class="annottext">Rand
</span><a href="#local-6989586621679112023"><span class="hs-identifier hs-var">randomVal</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-251"></span><span>            </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#Composite"><span class="hs-identifier hs-var">Composite</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#Composite"><span class="hs-identifier hs-var">Composite</span></a></span><span>
</span><span id="line-252"></span><span>            </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#ProbablyPrime"><span class="hs-identifier hs-var">ProbablyPrime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StdGen -&gt; Int -&gt; MaybePrime
</span><a href="#local-6989586621679112016"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679112024"><span class="hs-identifier hs-var">g'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112022"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#millerRabin"><span class="hs-pragma hs-type">millerRabin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">-- | For \(n, r, d, x\) with \(n = 2^{r} d + 1\) and \(x \in [2, n - 2] \),</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- returns 'Composite' if \(n\) is definitely composite, 'ProbablyPrime'</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- otherwise.</span><span>
</span><span id="line-258"></span><span class="hs-comment">--</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- ==== __Examples__</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- &gt;&gt;&gt; trial 12 (factor2 (12 - 1)) 3</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- Composite</span><span>
</span><span id="line-262"></span><span class="hs-comment">--</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- &gt;&gt;&gt; trial 7 (factor2 (7 - 1)) 3</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- ProbablyPrime</span><span>
</span><span id="line-265"></span><span class="hs-comment">--</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-267"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#trial"><span class="hs-identifier hs-type">trial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Modulus"><span class="hs-identifier hs-type">Modulus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Pow"><span class="hs-identifier hs-type">Pow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MaybePrime"><span class="hs-identifier hs-type">MaybePrime</span></a></span><span>
</span><span id="line-268"></span><span id="trial"><span class="annot"><span class="annottext">trial :: Modulus -&gt; (Pow, Mult) -&gt; Rand -&gt; MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#trial"><span class="hs-identifier hs-var hs-var">trial</span></a></span></span><span> </span><span id="local-6989586621679112026"><span class="annot"><span class="annottext">modulus :: Modulus
</span><a href="#local-6989586621679112026"><span class="hs-identifier hs-var">modulus</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkModulus"><span class="hs-identifier hs-type">MkModulus</span></a></span><span> </span><span id="local-6989586621679112027"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112027"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112028"><span class="annot"><span class="annottext">Pow
</span><a href="#local-6989586621679112028"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112029"><span class="annot"><span class="annottext">Mult
</span><a href="#local-6989586621679112029"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkRand"><span class="hs-identifier hs-type">MkRand</span></a></span><span> </span><span id="local-6989586621679112030"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112030"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-comment">-- x = 1 or n - 1 -&gt; skip</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112031"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112031"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112027"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#ProbablyPrime"><span class="hs-identifier hs-var">ProbablyPrime</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-comment">-- if we found a witness then n is definitely composite</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modulus -&gt; Pow -&gt; Rand -&gt; MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#isWitness"><span class="hs-identifier hs-var">isWitness</span></a></span><span> </span><span class="annot"><span class="annottext">Modulus
</span><a href="#local-6989586621679112026"><span class="hs-identifier hs-var">modulus</span></a></span><span> </span><span class="annot"><span class="annottext">Pow
</span><a href="#local-6989586621679112028"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Rand
</span><a href="Numeric.Data.ModP.Internal.Primality.html#MkRand"><span class="hs-identifier hs-var">MkRand</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112031"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621679112031"><span class="annot"><span class="annottext">x :: Integer
</span><a href="#local-6989586621679112031"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112030"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Mult -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Mult
</span><a href="#local-6989586621679112029"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112027"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-275"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#trial"><span class="hs-pragma hs-type">trial</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">-- | For \(n, r, x\) with \(n = 2^{r} d + 1\) and some</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- \(x \equiv a^d \pmod n \), returns 'Composite' if \(x\) is a witness to</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- \(n\) being composite. Otherwise returns 'ProbablyPrime'.</span><span>
</span><span id="line-280"></span><span class="hs-comment">--</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- ==== __Examples__</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- &gt;&gt;&gt; let (pow, mult) = factor2 (12 - 1)</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- &gt;&gt;&gt; let testVal = 3 ^ mult `mod` 12</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- &gt;&gt;&gt; isWitness 12 pow testVal</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- Composite</span><span>
</span><span id="line-286"></span><span class="hs-comment">--</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- &gt;&gt;&gt; let (pow, mult) = factor2 (7 - 1)</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- &gt;&gt;&gt; let testVal = 3 ^ mult `mod` 7</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- &gt;&gt;&gt; isWitness 7 pow testVal</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- ProbablyPrime</span><span>
</span><span id="line-291"></span><span class="hs-comment">--</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-293"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isWitness"><span class="hs-identifier hs-type">isWitness</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Modulus"><span class="hs-identifier hs-type">Modulus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Pow"><span class="hs-identifier hs-type">Pow</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MaybePrime"><span class="hs-identifier hs-type">MaybePrime</span></a></span><span>
</span><span id="line-294"></span><span id="isWitness"><span class="annot"><span class="annottext">isWitness :: Modulus -&gt; Pow -&gt; Rand -&gt; MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#isWitness"><span class="hs-identifier hs-var hs-var">isWitness</span></a></span></span><span> </span><span id="local-6989586621679112034"><span class="annot"><span class="annottext">modulus :: Modulus
</span><a href="#local-6989586621679112034"><span class="hs-identifier hs-var">modulus</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkModulus"><span class="hs-identifier hs-type">MkModulus</span></a></span><span> </span><span id="local-6989586621679112035"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112035"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679112036"><span class="annot"><span class="annottext">Pow
</span><a href="#local-6989586621679112036"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkRand"><span class="hs-identifier hs-type">MkRand</span></a></span><span> </span><span id="local-6989586621679112037"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112037"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; MaybePrime
</span><a href="#local-6989586621679112038"><span class="hs-identifier hs-var">coprimeToResult</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679112039"><span class="hs-identifier hs-var">coprime</span></a></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-296"></span><span>    </span><span id="local-6989586621679112040"><span class="annot"><span class="annottext">squares :: [Integer]
</span><a href="#local-6989586621679112040"><span class="hs-identifier hs-var hs-var">squares</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Integer] -&gt; [Integer]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pow -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Pow
</span><a href="#local-6989586621679112036"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Integer] -&gt; [Integer]) -&gt; [Integer] -&gt; [Integer]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Modulus -&gt; Integer -&gt; [Integer]
</span><a href="Numeric.Data.ModP.Internal.Primality.html#sqProgression"><span class="hs-identifier hs-var">sqProgression</span></a></span><span> </span><span class="annot"><span class="annottext">Modulus
</span><a href="#local-6989586621679112034"><span class="hs-identifier hs-var">modulus</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112037"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span id="local-6989586621679112039"><span class="annot"><span class="annottext">coprime :: Bool
</span><a href="#local-6989586621679112039"><span class="hs-identifier hs-var hs-var">coprime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112035"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Integer] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: Type -&gt; Type) a.
(Foldable t, Eq a) =&gt;
a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679112040"><span class="hs-identifier hs-var">squares</span></a></span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621679112038"><span class="annot"><span class="annottext">coprimeToResult :: Bool -&gt; MaybePrime
</span><a href="#local-6989586621679112038"><span class="hs-identifier hs-var hs-var">coprimeToResult</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#ProbablyPrime"><span class="hs-identifier hs-var">ProbablyPrime</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><a href="#local-6989586621679112038"><span class="hs-identifier hs-var">coprimeToResult</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybePrime
</span><a href="Numeric.Data.ModP.Internal.Primality.html#Composite"><span class="hs-identifier hs-var">Composite</span></a></span><span>
</span><span id="line-300"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#isWitness"><span class="hs-pragma hs-type">isWitness</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">-- | For \(n, x\), returns the infinite progression</span><span>
</span><span id="line-303"></span><span class="hs-comment">--</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- \[</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- x, x^2, x^4, x^8, \ldots \pmod n.</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-307"></span><span class="hs-comment">--</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- ==== __Examples__</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- &gt;&gt;&gt; take 5 $ sqProgression 7 3</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- [3,2,4,2,4]</span><span>
</span><span id="line-311"></span><span class="hs-comment">--</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-313"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#sqProgression"><span class="hs-identifier hs-type">sqProgression</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Modulus"><span class="hs-identifier hs-type">Modulus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span>
</span><span id="line-314"></span><span id="sqProgression"><span class="annot"><span class="annottext">sqProgression :: Modulus -&gt; Integer -&gt; [Integer]
</span><a href="Numeric.Data.ModP.Internal.Primality.html#sqProgression"><span class="hs-identifier hs-var hs-var">sqProgression</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkModulus"><span class="hs-identifier hs-type">MkModulus</span></a></span><span> </span><span id="local-6989586621679112043"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112043"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Integer]
</span><a href="#local-6989586621679112044"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>    </span><span id="local-6989586621679112044"><span class="annot"><span class="annottext">go :: Integer -&gt; [Integer]
</span><a href="#local-6989586621679112044"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679112045"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112045"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112045"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Integer] -&gt; [Integer]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Integer]
</span><a href="#local-6989586621679112044"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112045"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112043"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#sqProgression"><span class="hs-pragma hs-type">sqProgression</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">-- | Given \(n\), returns \((r, d)\) such that \(n = 2^r d\) with \(d\) odd</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- i.e. \(2\) has been factored out.</span><span>
</span><span id="line-321"></span><span class="hs-comment">--</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- ==== __Examples__</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- &gt;&gt;&gt; factor2 7</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- (MkPow 0,MkMult 7)</span><span>
</span><span id="line-325"></span><span class="hs-comment">--</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- &gt;&gt;&gt; factor2 8</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- (MkPow 3,MkMult 1)</span><span>
</span><span id="line-328"></span><span class="hs-comment">--</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- &gt;&gt;&gt; factor2 20</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- (MkPow 2,MkMult 5)</span><span>
</span><span id="line-331"></span><span class="hs-comment">--</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-333"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#factor2"><span class="hs-identifier hs-type">factor2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Modulus"><span class="hs-identifier hs-type">Modulus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Pow"><span class="hs-identifier hs-type">Pow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span id="factor2"><span class="annot"><span class="annottext">factor2 :: Modulus -&gt; (Pow, Mult)
</span><a href="Numeric.Data.ModP.Internal.Primality.html#factor2"><span class="hs-identifier hs-var hs-var">factor2</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkModulus"><span class="hs-identifier hs-type">MkModulus</span></a></span><span> </span><span id="local-6989586621679112046"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112046"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pow, Mult) -&gt; (Pow, Mult)
forall {b} {a}. (Num a, Integral b) =&gt; (a, b) -&gt; (a, b)
</span><a href="#local-6989586621679112047"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Pow
</span><a href="Numeric.Data.ModP.Internal.Primality.html#MkPow"><span class="hs-identifier hs-var">MkPow</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Mult
</span><a href="Numeric.Data.ModP.Internal.Primality.html#MkMult"><span class="hs-identifier hs-var">MkMult</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112046"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-336"></span><span>    </span><span id="local-6989586621679112047"><span class="annot"><span class="annottext">go :: (a, b) -&gt; (a, b)
</span><a href="#local-6989586621679112047"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679112075"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679112075"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679112076"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679112076"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679112076"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679112075"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">b -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">even</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679112076"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; (a, b)
</span><a href="#local-6989586621679112047"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679112075"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679112076"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679112075"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679112076"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#factor2"><span class="hs-pragma hs-type">factor2</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-comment">{- ORMOLU_DISABLE -}</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><span class="hs-comment">-- | Finds the multiplicative inverse.</span></span><span>
</span><span id="line-345"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#invert"><span class="hs-identifier hs-type">invert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679111203"><span class="annot"><a href="#local-6989586621679111203"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111203"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-cpp">
#if USE_ARITHMOI
</span><span class="hs-identifier">invert</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">invertArithmoi</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">p</span><span class="hs-cpp">
#else
</span><span id="invert"><span class="annot"><span class="annottext">invert :: forall (p :: Nat). KnownNat p =&gt; Nat -&gt; Nat
</span><a href="Numeric.Data.ModP.Internal.Primality.html#invert"><span class="hs-identifier hs-var hs-var">invert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (p :: Nat). KnownNat p =&gt; Nat -&gt; Nat
</span><a href="Numeric.Data.ModP.Internal.Primality.html#invertDefault"><span class="hs-identifier hs-var">invertDefault</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111203"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#invert"><span class="hs-pragma hs-type">invert</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">-- | Finds the multiplicative inverse with arithmoi if available, otherwise</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- errors.</span><span>
</span><span id="line-355"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#invertArithmoi"><span class="hs-identifier hs-type">invertArithmoi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679112079"><span class="annot"><a href="#local-6989586621679112079"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679112079"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-cpp">
#if USE_ARITHMOI
</span><span class="hs-identifier">invertArithmoi</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">Mod.invertMod</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Mod</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-360"></span><span>      </span><span class="hs-identifier">error</span><span>
</span><span id="line-361"></span><span>        </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">errMsg</span><span>
</span><span id="line-362"></span><span>            </span><span class="hs-special">(</span><span class="hs-string">&quot;Could not find inverse of &quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-string">&quot; (mod &quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">p'</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Mod.unMod</span><span> </span><span class="hs-identifier">n</span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-identifier">p'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">natVal</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">Proxy</span><span class="hs-cpp">
#else
</span><span id="invertArithmoi"><span class="annot"><span class="annottext">invertArithmoi :: forall (p :: Nat). KnownNat p =&gt; Nat -&gt; Nat
</span><a href="Numeric.Data.ModP.Internal.Primality.html#invertArithmoi"><span class="hs-identifier hs-var hs-var">invertArithmoi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-368"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Nat -&gt; Nat
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; Nat -&gt; Nat) -&gt; String -&gt; Nat -&gt; Nat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Numeric.Data.ModP.Internal.Primality.html#errMsg"><span class="hs-identifier hs-var">errMsg</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arithmoi flag is disabled. Either turn the flag on or use one of invert, invertDefault.&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-373"></span><span class="annot"><span class="hs-comment">-- | Finds the multiplicative inverse using the built-in algorithm.</span></span><span>
</span><span id="line-374"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#invertDefault"><span class="hs-identifier hs-type">invertDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679112083"><span class="annot"><a href="#local-6989586621679112083"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679112083"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-375"></span><span id="invertDefault"><span class="annot"><span class="annottext">invertDefault :: forall (p :: Nat). KnownNat p =&gt; Nat -&gt; Nat
</span><a href="Numeric.Data.ModP.Internal.Primality.html#invertDefault"><span class="hs-identifier hs-var hs-var">invertDefault</span></a></span></span><span> </span><span id="local-6989586621679112093"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621679112093"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Nat
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Nat) -&gt; Integer -&gt; Nat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Modulus -&gt; Integer
</span><a href="Numeric.Data.ModP.Internal.Primality.html#findInverse"><span class="hs-identifier hs-var">findInverse</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112094"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulus
</span><a href="#local-6989586621679112095"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-377"></span><span>    </span><span id="local-6989586621679112095"><span class="annot"><span class="annottext">p' :: Modulus
</span><a href="#local-6989586621679112095"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Modulus
</span><a href="Numeric.Data.ModP.Internal.Primality.html#MkModulus"><span class="hs-identifier hs-var">MkModulus</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Modulus) -&gt; Integer -&gt; Modulus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Nat -&gt; Integer) -&gt; Nat -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Nat
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679112083"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy p
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-378"></span><span>    </span><span id="local-6989586621679112094"><span class="annot"><span class="annottext">d' :: Integer
</span><a href="#local-6989586621679112094"><span class="hs-identifier hs-var hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621679112093"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">{- ORMOLU_ENABLE -}</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">-- | For \(a, p\), finds the multiplicative inverse of \(a\) in</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- \(\mathbb{Z}/p\mathbb{Z}\). That is, finds /e/ such that</span><span>
</span><span id="line-384"></span><span class="hs-comment">--</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- \[</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- ae \equiv 1 \pmod p.</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-388"></span><span class="hs-comment">--</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- Note: The returned \(e\) is only an inverse when \(a\) and \(p\) are</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- coprime i.e. \((a,p) = 1\). Of course this is guaranteed when \(p\) is</span><span>
</span><span id="line-391"></span><span class="hs-comment">-- prime and \(0 &lt; a &lt; p \), but it otherwise not true in general.</span><span>
</span><span id="line-392"></span><span class="hs-comment">--</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- Also, this function requires division, it is partial when</span><span>
</span><span id="line-394"></span><span class="hs-comment">-- the modulus is 0.</span><span>
</span><span id="line-395"></span><span class="hs-comment">--</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-397"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#findInverse"><span class="hs-identifier hs-type">findInverse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Modulus"><span class="hs-identifier hs-type">Modulus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-398"></span><span id="findInverse"><span class="annot"><span class="annottext">findInverse :: Integer -&gt; Modulus -&gt; Integer
</span><a href="Numeric.Data.ModP.Internal.Primality.html#findInverse"><span class="hs-identifier hs-var hs-var">findInverse</span></a></span></span><span> </span><span id="local-6989586621679112096"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112096"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkModulus"><span class="hs-identifier hs-type">MkModulus</span></a></span><span> </span><span id="local-6989586621679112097"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112097"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112098"><span class="hs-identifier hs-var">aInv</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112097"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkBezout"><span class="hs-identifier hs-type">MkBezout</span></a></span><span> </span><span class="annot"><span class="annottext">R
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">S
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#T%27"><span class="hs-identifier hs-type">T'</span></a></span><span> </span><span id="local-6989586621679112098"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112098"><span class="hs-identifier hs-var">aInv</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bezout
</span><a href="Numeric.Data.ModP.Internal.Primality.html#eec"><span class="hs-identifier hs-var">eec</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112097"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112096"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-401"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#findInverse"><span class="hs-pragma hs-type">findInverse</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="annot"><span class="hs-comment">-- | @since 0.1</span></span><span>
</span><span id="line-404"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#findBezout"><span class="hs-identifier hs-type">findBezout</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Modulus"><span class="hs-identifier hs-type">Modulus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Bezout"><span class="hs-identifier hs-type">Bezout</span></a></span><span>
</span><span id="line-405"></span><span id="findBezout"><span class="annot"><span class="annottext">findBezout :: Integer -&gt; Modulus -&gt; Bezout
</span><a href="Numeric.Data.ModP.Internal.Primality.html#findBezout"><span class="hs-identifier hs-var hs-var">findBezout</span></a></span></span><span> </span><span id="local-6989586621679112102"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112102"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkModulus"><span class="hs-identifier hs-type">MkModulus</span></a></span><span> </span><span id="local-6989586621679112103"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112103"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bezout
</span><a href="Numeric.Data.ModP.Internal.Primality.html#eec"><span class="hs-identifier hs-var">eec</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112103"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112102"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-406"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#findBezout"><span class="hs-pragma hs-type">findBezout</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="annot"><span class="hs-comment">-- | @since 0.1t</span></span><span>
</span><span id="line-409"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Bezout"><span class="hs-identifier hs-type">Bezout</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-410"></span><span class="hs-keyword">data</span><span> </span><span id="Bezout"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Bezout"><span class="hs-identifier hs-var">Bezout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkBezout"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#MkBezout"><span class="hs-identifier hs-var">MkBezout</span></a></span></span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="bzGcd"><span class="annot"><span class="annottext">Bezout -&gt; R
</span><a href="Numeric.Data.ModP.Internal.Primality.html#bzGcd"><span class="hs-identifier hs-var hs-var">bzGcd</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#R"><span class="hs-identifier hs-type">R</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-412"></span><span>    </span><span id="bzS"><span class="annot"><span class="annottext">Bezout -&gt; S
</span><a href="Numeric.Data.ModP.Internal.Primality.html#bzS"><span class="hs-identifier hs-var hs-var">bzS</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#S"><span class="hs-identifier hs-type">S</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-413"></span><span>    </span><span id="bzT"><span class="annot"><span class="annottext">Bezout -&gt; T
</span><a href="Numeric.Data.ModP.Internal.Primality.html#bzT"><span class="hs-identifier hs-var hs-var">bzT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#T"><span class="hs-identifier hs-type">T</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112108"><span id="local-6989586621679112116"><span class="annot"><span class="annottext">Bezout -&gt; Bezout -&gt; Bool
(Bezout -&gt; Bezout -&gt; Bool)
-&gt; (Bezout -&gt; Bezout -&gt; Bool) -&gt; Eq Bezout
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Bezout -&gt; Bezout -&gt; Bool
== :: Bezout -&gt; Bezout -&gt; Bool
$c/= :: Bezout -&gt; Bezout -&gt; Bool
/= :: Bezout -&gt; Bezout -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112120"><span id="local-6989586621679112129"><span id="local-6989586621679112133"><span class="annot"><span class="annottext">Int -&gt; Bezout -&gt; ShowS
[Bezout] -&gt; ShowS
Bezout -&gt; String
(Int -&gt; Bezout -&gt; ShowS)
-&gt; (Bezout -&gt; String) -&gt; ([Bezout] -&gt; ShowS) -&gt; Show Bezout
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Bezout -&gt; ShowS
showsPrec :: Int -&gt; Bezout -&gt; ShowS
$cshow :: Bezout -&gt; String
show :: Bezout -&gt; String
$cshowList :: [Bezout] -&gt; ShowS
showList :: [Bezout] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="annot"><span class="hs-comment">-- | @since 0.1</span></span><span>
</span><span id="line-418"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#R"><span class="hs-identifier hs-type">R</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-419"></span><span class="hs-keyword">newtype</span><span> </span><span id="R"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#R"><span class="hs-identifier hs-var">R</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="R%27"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#R%27"><span class="hs-identifier hs-var">R'</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112137"><span id="local-6989586621679112140"><span class="annot"><span class="annottext">R -&gt; R -&gt; Bool
(R -&gt; R -&gt; Bool) -&gt; (R -&gt; R -&gt; Bool) -&gt; Eq R
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: R -&gt; R -&gt; Bool
== :: R -&gt; R -&gt; Bool
$c/= :: R -&gt; R -&gt; Bool
/= :: R -&gt; R -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112143"><span id="local-6989586621679112147"><span id="local-6989586621679112150"><span class="annot"><span class="annottext">Int -&gt; R -&gt; ShowS
[R] -&gt; ShowS
R -&gt; String
(Int -&gt; R -&gt; ShowS) -&gt; (R -&gt; String) -&gt; ([R] -&gt; ShowS) -&gt; Show R
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; R -&gt; ShowS
showsPrec :: Int -&gt; R -&gt; ShowS
$cshow :: R -&gt; String
show :: R -&gt; String
$cshowList :: [R] -&gt; ShowS
showList :: [R] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112155"><span id="local-6989586621679112158"><span id="local-6989586621679112161"><span id="local-6989586621679112165"><span id="local-6989586621679112168"><span id="local-6989586621679112171"><span id="local-6989586621679112174"><span class="annot"><span class="annottext">Eq R
Eq R =&gt;
(R -&gt; R -&gt; Ordering)
-&gt; (R -&gt; R -&gt; Bool)
-&gt; (R -&gt; R -&gt; Bool)
-&gt; (R -&gt; R -&gt; Bool)
-&gt; (R -&gt; R -&gt; Bool)
-&gt; (R -&gt; R -&gt; R)
-&gt; (R -&gt; R -&gt; R)
-&gt; Ord R
R -&gt; R -&gt; Bool
R -&gt; R -&gt; Ordering
R -&gt; R -&gt; R
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: R -&gt; R -&gt; Ordering
compare :: R -&gt; R -&gt; Ordering
$c&lt; :: R -&gt; R -&gt; Bool
&lt; :: R -&gt; R -&gt; Bool
$c&lt;= :: R -&gt; R -&gt; Bool
&lt;= :: R -&gt; R -&gt; Bool
$c&gt; :: R -&gt; R -&gt; Bool
&gt; :: R -&gt; R -&gt; Bool
$c&gt;= :: R -&gt; R -&gt; Bool
&gt;= :: R -&gt; R -&gt; Bool
$cmax :: R -&gt; R -&gt; R
max :: R -&gt; R -&gt; R
$cmin :: R -&gt; R -&gt; R
min :: R -&gt; R -&gt; R
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112177"><span id="local-6989586621679112181"><span id="local-6989586621679112185"><span id="local-6989586621679112189"><span id="local-6989586621679112193"><span id="local-6989586621679112197"><span id="local-6989586621679112201"><span id="local-6989586621679112205"><span class="annot"><span class="annottext">Int -&gt; R
R -&gt; Int
R -&gt; [R]
R -&gt; R
R -&gt; R -&gt; [R]
R -&gt; R -&gt; R -&gt; [R]
(R -&gt; R)
-&gt; (R -&gt; R)
-&gt; (Int -&gt; R)
-&gt; (R -&gt; Int)
-&gt; (R -&gt; [R])
-&gt; (R -&gt; R -&gt; [R])
-&gt; (R -&gt; R -&gt; [R])
-&gt; (R -&gt; R -&gt; R -&gt; [R])
-&gt; Enum R
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
$csucc :: R -&gt; R
succ :: R -&gt; R
$cpred :: R -&gt; R
pred :: R -&gt; R
$ctoEnum :: Int -&gt; R
toEnum :: Int -&gt; R
$cfromEnum :: R -&gt; Int
fromEnum :: R -&gt; Int
$cenumFrom :: R -&gt; [R]
enumFrom :: R -&gt; [R]
$cenumFromThen :: R -&gt; R -&gt; [R]
enumFromThen :: R -&gt; R -&gt; [R]
$cenumFromTo :: R -&gt; R -&gt; [R]
enumFromTo :: R -&gt; R -&gt; [R]
$cenumFromThenTo :: R -&gt; R -&gt; R -&gt; [R]
enumFromThenTo :: R -&gt; R -&gt; R -&gt; [R]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112215"><span id="local-6989586621679112219"><span id="local-6989586621679112223"><span id="local-6989586621679112227"><span id="local-6989586621679112231"><span id="local-6989586621679112235"><span id="local-6989586621679112239"><span class="annot"><span class="annottext">Enum R
Real R
(Real R, Enum R) =&gt;
(R -&gt; R -&gt; R)
-&gt; (R -&gt; R -&gt; R)
-&gt; (R -&gt; R -&gt; R)
-&gt; (R -&gt; R -&gt; R)
-&gt; (R -&gt; R -&gt; (R, R))
-&gt; (R -&gt; R -&gt; (R, R))
-&gt; (R -&gt; Integer)
-&gt; Integral R
R -&gt; Integer
R -&gt; R -&gt; (R, R)
R -&gt; R -&gt; R
forall a.
(Real a, Enum a) =&gt;
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; Integer)
-&gt; Integral a
$cquot :: R -&gt; R -&gt; R
quot :: R -&gt; R -&gt; R
$crem :: R -&gt; R -&gt; R
rem :: R -&gt; R -&gt; R
$cdiv :: R -&gt; R -&gt; R
div :: R -&gt; R -&gt; R
$cmod :: R -&gt; R -&gt; R
mod :: R -&gt; R -&gt; R
$cquotRem :: R -&gt; R -&gt; (R, R)
quotRem :: R -&gt; R -&gt; (R, R)
$cdivMod :: R -&gt; R -&gt; (R, R)
divMod :: R -&gt; R -&gt; (R, R)
$ctoInteger :: R -&gt; Integer
toInteger :: R -&gt; Integer
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Integral</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112244"><span id="local-6989586621679112248"><span id="local-6989586621679112252"><span id="local-6989586621679112256"><span id="local-6989586621679112260"><span id="local-6989586621679112264"><span id="local-6989586621679112268"><span class="annot"><span class="annottext">Integer -&gt; R
R -&gt; R
R -&gt; R -&gt; R
(R -&gt; R -&gt; R)
-&gt; (R -&gt; R -&gt; R)
-&gt; (R -&gt; R -&gt; R)
-&gt; (R -&gt; R)
-&gt; (R -&gt; R)
-&gt; (R -&gt; R)
-&gt; (Integer -&gt; R)
-&gt; Num R
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: R -&gt; R -&gt; R
+ :: R -&gt; R -&gt; R
$c- :: R -&gt; R -&gt; R
- :: R -&gt; R -&gt; R
$c* :: R -&gt; R -&gt; R
* :: R -&gt; R -&gt; R
$cnegate :: R -&gt; R
negate :: R -&gt; R
$cabs :: R -&gt; R
abs :: R -&gt; R
$csignum :: R -&gt; R
signum :: R -&gt; R
$cfromInteger :: Integer -&gt; R
fromInteger :: Integer -&gt; R
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112277"><span class="annot"><span class="annottext">Num R
Ord R
(Num R, Ord R) =&gt; (R -&gt; Rational) -&gt; Real R
R -&gt; Rational
forall a. (Num a, Ord a) =&gt; (a -&gt; Rational) -&gt; Real a
$ctoRational :: R -&gt; Rational
toRational :: R -&gt; Rational
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Real</span></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="annot"><span class="hs-comment">-- | @since 0.1</span></span><span>
</span><span id="line-424"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-425"></span><span class="hs-keyword">newtype</span><span> </span><span id="S"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#S"><span class="hs-identifier hs-var">S</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="S%27"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#S%27"><span class="hs-identifier hs-var">S'</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112282"><span id="local-6989586621679112285"><span class="annot"><span class="annottext">S -&gt; S -&gt; Bool
(S -&gt; S -&gt; Bool) -&gt; (S -&gt; S -&gt; Bool) -&gt; Eq S
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: S -&gt; S -&gt; Bool
== :: S -&gt; S -&gt; Bool
$c/= :: S -&gt; S -&gt; Bool
/= :: S -&gt; S -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112288"><span id="local-6989586621679112292"><span id="local-6989586621679112295"><span class="annot"><span class="annottext">Int -&gt; S -&gt; ShowS
[S] -&gt; ShowS
S -&gt; String
(Int -&gt; S -&gt; ShowS) -&gt; (S -&gt; String) -&gt; ([S] -&gt; ShowS) -&gt; Show S
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; S -&gt; ShowS
showsPrec :: Int -&gt; S -&gt; ShowS
$cshow :: S -&gt; String
show :: S -&gt; String
$cshowList :: [S] -&gt; ShowS
showList :: [S] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112300"><span id="local-6989586621679112303"><span id="local-6989586621679112306"><span id="local-6989586621679112310"><span id="local-6989586621679112313"><span id="local-6989586621679112316"><span id="local-6989586621679112319"><span class="annot"><span class="annottext">Eq S
Eq S =&gt;
(S -&gt; S -&gt; Ordering)
-&gt; (S -&gt; S -&gt; Bool)
-&gt; (S -&gt; S -&gt; Bool)
-&gt; (S -&gt; S -&gt; Bool)
-&gt; (S -&gt; S -&gt; Bool)
-&gt; (S -&gt; S -&gt; S)
-&gt; (S -&gt; S -&gt; S)
-&gt; Ord S
S -&gt; S -&gt; Bool
S -&gt; S -&gt; Ordering
S -&gt; S -&gt; S
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: S -&gt; S -&gt; Ordering
compare :: S -&gt; S -&gt; Ordering
$c&lt; :: S -&gt; S -&gt; Bool
&lt; :: S -&gt; S -&gt; Bool
$c&lt;= :: S -&gt; S -&gt; Bool
&lt;= :: S -&gt; S -&gt; Bool
$c&gt; :: S -&gt; S -&gt; Bool
&gt; :: S -&gt; S -&gt; Bool
$c&gt;= :: S -&gt; S -&gt; Bool
&gt;= :: S -&gt; S -&gt; Bool
$cmax :: S -&gt; S -&gt; S
max :: S -&gt; S -&gt; S
$cmin :: S -&gt; S -&gt; S
min :: S -&gt; S -&gt; S
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112322"><span id="local-6989586621679112326"><span id="local-6989586621679112330"><span id="local-6989586621679112334"><span id="local-6989586621679112338"><span id="local-6989586621679112342"><span id="local-6989586621679112346"><span id="local-6989586621679112350"><span class="annot"><span class="annottext">Int -&gt; S
S -&gt; Int
S -&gt; [S]
S -&gt; S
S -&gt; S -&gt; [S]
S -&gt; S -&gt; S -&gt; [S]
(S -&gt; S)
-&gt; (S -&gt; S)
-&gt; (Int -&gt; S)
-&gt; (S -&gt; Int)
-&gt; (S -&gt; [S])
-&gt; (S -&gt; S -&gt; [S])
-&gt; (S -&gt; S -&gt; [S])
-&gt; (S -&gt; S -&gt; S -&gt; [S])
-&gt; Enum S
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
$csucc :: S -&gt; S
succ :: S -&gt; S
$cpred :: S -&gt; S
pred :: S -&gt; S
$ctoEnum :: Int -&gt; S
toEnum :: Int -&gt; S
$cfromEnum :: S -&gt; Int
fromEnum :: S -&gt; Int
$cenumFrom :: S -&gt; [S]
enumFrom :: S -&gt; [S]
$cenumFromThen :: S -&gt; S -&gt; [S]
enumFromThen :: S -&gt; S -&gt; [S]
$cenumFromTo :: S -&gt; S -&gt; [S]
enumFromTo :: S -&gt; S -&gt; [S]
$cenumFromThenTo :: S -&gt; S -&gt; S -&gt; [S]
enumFromThenTo :: S -&gt; S -&gt; S -&gt; [S]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112360"><span id="local-6989586621679112364"><span id="local-6989586621679112368"><span id="local-6989586621679112372"><span id="local-6989586621679112376"><span id="local-6989586621679112380"><span id="local-6989586621679112384"><span class="annot"><span class="annottext">Enum S
Real S
(Real S, Enum S) =&gt;
(S -&gt; S -&gt; S)
-&gt; (S -&gt; S -&gt; S)
-&gt; (S -&gt; S -&gt; S)
-&gt; (S -&gt; S -&gt; S)
-&gt; (S -&gt; S -&gt; (S, S))
-&gt; (S -&gt; S -&gt; (S, S))
-&gt; (S -&gt; Integer)
-&gt; Integral S
S -&gt; Integer
S -&gt; S -&gt; (S, S)
S -&gt; S -&gt; S
forall a.
(Real a, Enum a) =&gt;
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; Integer)
-&gt; Integral a
$cquot :: S -&gt; S -&gt; S
quot :: S -&gt; S -&gt; S
$crem :: S -&gt; S -&gt; S
rem :: S -&gt; S -&gt; S
$cdiv :: S -&gt; S -&gt; S
div :: S -&gt; S -&gt; S
$cmod :: S -&gt; S -&gt; S
mod :: S -&gt; S -&gt; S
$cquotRem :: S -&gt; S -&gt; (S, S)
quotRem :: S -&gt; S -&gt; (S, S)
$cdivMod :: S -&gt; S -&gt; (S, S)
divMod :: S -&gt; S -&gt; (S, S)
$ctoInteger :: S -&gt; Integer
toInteger :: S -&gt; Integer
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Integral</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112389"><span id="local-6989586621679112393"><span id="local-6989586621679112397"><span id="local-6989586621679112401"><span id="local-6989586621679112405"><span id="local-6989586621679112409"><span id="local-6989586621679112413"><span class="annot"><span class="annottext">Integer -&gt; S
S -&gt; S
S -&gt; S -&gt; S
(S -&gt; S -&gt; S)
-&gt; (S -&gt; S -&gt; S)
-&gt; (S -&gt; S -&gt; S)
-&gt; (S -&gt; S)
-&gt; (S -&gt; S)
-&gt; (S -&gt; S)
-&gt; (Integer -&gt; S)
-&gt; Num S
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: S -&gt; S -&gt; S
+ :: S -&gt; S -&gt; S
$c- :: S -&gt; S -&gt; S
- :: S -&gt; S -&gt; S
$c* :: S -&gt; S -&gt; S
* :: S -&gt; S -&gt; S
$cnegate :: S -&gt; S
negate :: S -&gt; S
$cabs :: S -&gt; S
abs :: S -&gt; S
$csignum :: S -&gt; S
signum :: S -&gt; S
$cfromInteger :: Integer -&gt; S
fromInteger :: Integer -&gt; S
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112422"><span class="annot"><span class="annottext">Num S
Ord S
(Num S, Ord S) =&gt; (S -&gt; Rational) -&gt; Real S
S -&gt; Rational
forall a. (Num a, Ord a) =&gt; (a -&gt; Rational) -&gt; Real a
$ctoRational :: S -&gt; Rational
toRational :: S -&gt; Rational
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Real</span></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="annot"><span class="hs-comment">-- | @since 0.1</span></span><span>
</span><span id="line-430"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-431"></span><span class="hs-keyword">newtype</span><span> </span><span id="T"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#T"><span class="hs-identifier hs-var">T</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="T%27"><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#T%27"><span class="hs-identifier hs-var">T'</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-432"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112426"><span id="local-6989586621679112429"><span class="annot"><span class="annottext">T -&gt; T -&gt; Bool
(T -&gt; T -&gt; Bool) -&gt; (T -&gt; T -&gt; Bool) -&gt; Eq T
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: T -&gt; T -&gt; Bool
== :: T -&gt; T -&gt; Bool
$c/= :: T -&gt; T -&gt; Bool
/= :: T -&gt; T -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112432"><span id="local-6989586621679112436"><span id="local-6989586621679112439"><span class="annot"><span class="annottext">Int -&gt; T -&gt; ShowS
[T] -&gt; ShowS
T -&gt; String
(Int -&gt; T -&gt; ShowS) -&gt; (T -&gt; String) -&gt; ([T] -&gt; ShowS) -&gt; Show T
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; T -&gt; ShowS
showsPrec :: Int -&gt; T -&gt; ShowS
$cshow :: T -&gt; String
show :: T -&gt; String
$cshowList :: [T] -&gt; ShowS
showList :: [T] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112444"><span id="local-6989586621679112447"><span id="local-6989586621679112450"><span id="local-6989586621679112454"><span id="local-6989586621679112457"><span id="local-6989586621679112460"><span id="local-6989586621679112463"><span class="annot"><span class="annottext">Eq T
Eq T =&gt;
(T -&gt; T -&gt; Ordering)
-&gt; (T -&gt; T -&gt; Bool)
-&gt; (T -&gt; T -&gt; Bool)
-&gt; (T -&gt; T -&gt; Bool)
-&gt; (T -&gt; T -&gt; Bool)
-&gt; (T -&gt; T -&gt; T)
-&gt; (T -&gt; T -&gt; T)
-&gt; Ord T
T -&gt; T -&gt; Bool
T -&gt; T -&gt; Ordering
T -&gt; T -&gt; T
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: T -&gt; T -&gt; Ordering
compare :: T -&gt; T -&gt; Ordering
$c&lt; :: T -&gt; T -&gt; Bool
&lt; :: T -&gt; T -&gt; Bool
$c&lt;= :: T -&gt; T -&gt; Bool
&lt;= :: T -&gt; T -&gt; Bool
$c&gt; :: T -&gt; T -&gt; Bool
&gt; :: T -&gt; T -&gt; Bool
$c&gt;= :: T -&gt; T -&gt; Bool
&gt;= :: T -&gt; T -&gt; Bool
$cmax :: T -&gt; T -&gt; T
max :: T -&gt; T -&gt; T
$cmin :: T -&gt; T -&gt; T
min :: T -&gt; T -&gt; T
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112466"><span id="local-6989586621679112470"><span id="local-6989586621679112474"><span id="local-6989586621679112478"><span id="local-6989586621679112482"><span id="local-6989586621679112486"><span id="local-6989586621679112490"><span id="local-6989586621679112494"><span class="annot"><span class="annottext">Int -&gt; T
T -&gt; Int
T -&gt; [T]
T -&gt; T
T -&gt; T -&gt; [T]
T -&gt; T -&gt; T -&gt; [T]
(T -&gt; T)
-&gt; (T -&gt; T)
-&gt; (Int -&gt; T)
-&gt; (T -&gt; Int)
-&gt; (T -&gt; [T])
-&gt; (T -&gt; T -&gt; [T])
-&gt; (T -&gt; T -&gt; [T])
-&gt; (T -&gt; T -&gt; T -&gt; [T])
-&gt; Enum T
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
$csucc :: T -&gt; T
succ :: T -&gt; T
$cpred :: T -&gt; T
pred :: T -&gt; T
$ctoEnum :: Int -&gt; T
toEnum :: Int -&gt; T
$cfromEnum :: T -&gt; Int
fromEnum :: T -&gt; Int
$cenumFrom :: T -&gt; [T]
enumFrom :: T -&gt; [T]
$cenumFromThen :: T -&gt; T -&gt; [T]
enumFromThen :: T -&gt; T -&gt; [T]
$cenumFromTo :: T -&gt; T -&gt; [T]
enumFromTo :: T -&gt; T -&gt; [T]
$cenumFromThenTo :: T -&gt; T -&gt; T -&gt; [T]
enumFromThenTo :: T -&gt; T -&gt; T -&gt; [T]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112504"><span id="local-6989586621679112508"><span id="local-6989586621679112512"><span id="local-6989586621679112516"><span id="local-6989586621679112520"><span id="local-6989586621679112524"><span id="local-6989586621679112528"><span class="annot"><span class="annottext">Enum T
Real T
(Real T, Enum T) =&gt;
(T -&gt; T -&gt; T)
-&gt; (T -&gt; T -&gt; T)
-&gt; (T -&gt; T -&gt; T)
-&gt; (T -&gt; T -&gt; T)
-&gt; (T -&gt; T -&gt; (T, T))
-&gt; (T -&gt; T -&gt; (T, T))
-&gt; (T -&gt; Integer)
-&gt; Integral T
T -&gt; Integer
T -&gt; T -&gt; (T, T)
T -&gt; T -&gt; T
forall a.
(Real a, Enum a) =&gt;
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; Integer)
-&gt; Integral a
$cquot :: T -&gt; T -&gt; T
quot :: T -&gt; T -&gt; T
$crem :: T -&gt; T -&gt; T
rem :: T -&gt; T -&gt; T
$cdiv :: T -&gt; T -&gt; T
div :: T -&gt; T -&gt; T
$cmod :: T -&gt; T -&gt; T
mod :: T -&gt; T -&gt; T
$cquotRem :: T -&gt; T -&gt; (T, T)
quotRem :: T -&gt; T -&gt; (T, T)
$cdivMod :: T -&gt; T -&gt; (T, T)
divMod :: T -&gt; T -&gt; (T, T)
$ctoInteger :: T -&gt; Integer
toInteger :: T -&gt; Integer
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Integral</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112533"><span id="local-6989586621679112537"><span id="local-6989586621679112541"><span id="local-6989586621679112545"><span id="local-6989586621679112549"><span id="local-6989586621679112553"><span id="local-6989586621679112557"><span class="annot"><span class="annottext">Integer -&gt; T
T -&gt; T
T -&gt; T -&gt; T
(T -&gt; T -&gt; T)
-&gt; (T -&gt; T -&gt; T)
-&gt; (T -&gt; T -&gt; T)
-&gt; (T -&gt; T)
-&gt; (T -&gt; T)
-&gt; (T -&gt; T)
-&gt; (Integer -&gt; T)
-&gt; Num T
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: T -&gt; T -&gt; T
+ :: T -&gt; T -&gt; T
$c- :: T -&gt; T -&gt; T
- :: T -&gt; T -&gt; T
$c* :: T -&gt; T -&gt; T
* :: T -&gt; T -&gt; T
$cnegate :: T -&gt; T
negate :: T -&gt; T
$cabs :: T -&gt; T
abs :: T -&gt; T
$csignum :: T -&gt; T
signum :: T -&gt; T
$cfromInteger :: Integer -&gt; T
fromInteger :: Integer -&gt; T
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112566"><span class="annot"><span class="annottext">Num T
Ord T
(Num T, Ord T) =&gt; (T -&gt; Rational) -&gt; Real T
T -&gt; Rational
forall a. (Num a, Ord a) =&gt; (a -&gt; Rational) -&gt; Real a
$ctoRational :: T -&gt; Rational
toRational :: T -&gt; Rational
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Real</span></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">-- Solves for Bezout's identity using the extended euclidean algorithm:</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm#Pseudocode</span><span>
</span><span id="line-437"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#eec"><span class="hs-identifier hs-type">eec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#Bezout"><span class="hs-identifier hs-type">Bezout</span></a></span><span>
</span><span id="line-438"></span><span id="eec"><span class="annot"><span class="annottext">eec :: Integer -&gt; Integer -&gt; Bezout
</span><a href="Numeric.Data.ModP.Internal.Primality.html#eec"><span class="hs-identifier hs-var hs-var">eec</span></a></span></span><span> </span><span id="local-6989586621679112569"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112569"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679112570"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112570"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">R -&gt; R -&gt; S -&gt; S -&gt; T -&gt; T -&gt; Bezout
</span><a href="#local-6989586621679112571"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">R
</span><a href="#local-6989586621679112572"><span class="hs-identifier hs-var">initOldR</span></a></span><span> </span><span class="annot"><span class="annottext">R
</span><a href="#local-6989586621679112573"><span class="hs-identifier hs-var">initR</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679112574"><span class="hs-identifier hs-var">initOldS</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679112575"><span class="hs-identifier hs-var">initS</span></a></span><span> </span><span class="annot"><span class="annottext">T
</span><a href="#local-6989586621679112576"><span class="hs-identifier hs-var">initOldT</span></a></span><span> </span><span class="annot"><span class="annottext">T
</span><a href="#local-6989586621679112577"><span class="hs-identifier hs-var">initT</span></a></span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-440"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679112572"><span class="annot"><span class="annottext">R
</span><a href="#local-6989586621679112572"><span class="hs-identifier hs-var">initOldR</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112573"><span class="annot"><span class="annottext">R
</span><a href="#local-6989586621679112573"><span class="hs-identifier hs-var">initR</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; R
</span><a href="Numeric.Data.ModP.Internal.Primality.html#R%27"><span class="hs-identifier hs-var">R'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112569"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; R
</span><a href="Numeric.Data.ModP.Internal.Primality.html#R%27"><span class="hs-identifier hs-var">R'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112570"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679112574"><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679112574"><span class="hs-identifier hs-var">initOldS</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112575"><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679112575"><span class="hs-identifier hs-var">initS</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; S
</span><a href="Numeric.Data.ModP.Internal.Primality.html#S%27"><span class="hs-identifier hs-var">S'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; S
</span><a href="Numeric.Data.ModP.Internal.Primality.html#S%27"><span class="hs-identifier hs-var">S'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679112576"><span class="annot"><span class="annottext">T
</span><a href="#local-6989586621679112576"><span class="hs-identifier hs-var">initOldT</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112577"><span class="annot"><span class="annottext">T
</span><a href="#local-6989586621679112577"><span class="hs-identifier hs-var">initT</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; T
</span><a href="Numeric.Data.ModP.Internal.Primality.html#T%27"><span class="hs-identifier hs-var">T'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; T
</span><a href="Numeric.Data.ModP.Internal.Primality.html#T%27"><span class="hs-identifier hs-var">T'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span>    </span><span id="local-6989586621679112571"><span class="annot"><span class="annottext">go :: R -&gt; R -&gt; S -&gt; S -&gt; T -&gt; T -&gt; Bezout
</span><a href="#local-6989586621679112571"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679112585"><span class="annot"><span class="annottext">R
</span><a href="#local-6989586621679112585"><span class="hs-identifier hs-var">oldR</span></a></span></span><span> </span><span class="annot"><span class="annottext">R
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679112586"><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679112586"><span class="hs-identifier hs-var">oldS</span></a></span></span><span> </span><span class="annot"><span class="annottext">S
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679112587"><span class="annot"><span class="annottext">T
</span><a href="#local-6989586621679112587"><span class="hs-identifier hs-var">oldT</span></a></span></span><span> </span><span class="annot"><span class="annottext">T
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">R -&gt; S -&gt; T -&gt; Bezout
</span><a href="Numeric.Data.ModP.Internal.Primality.html#MkBezout"><span class="hs-identifier hs-var">MkBezout</span></a></span><span> </span><span class="annot"><span class="annottext">R
</span><a href="#local-6989586621679112585"><span class="hs-identifier hs-var">oldR</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679112586"><span class="hs-identifier hs-var">oldS</span></a></span><span> </span><span class="annot"><span class="annottext">T
</span><a href="#local-6989586621679112587"><span class="hs-identifier hs-var">oldT</span></a></span><span>
</span><span id="line-445"></span><span>    </span><span class="annot"><a href="#local-6989586621679112571"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679112588"><span class="annot"><span class="annottext">R
</span><a href="#local-6989586621679112588"><span class="hs-identifier hs-var">oldR</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679112589"><span class="annot"><span class="annottext">R
</span><a href="#local-6989586621679112589"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679112590"><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679112590"><span class="hs-identifier hs-var">oldS</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679112591"><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679112591"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679112592"><span class="annot"><span class="annottext">T
</span><a href="#local-6989586621679112592"><span class="hs-identifier hs-var">oldT</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679112593"><span class="annot"><span class="annottext">T
</span><a href="#local-6989586621679112593"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-446"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679112594"><span class="annot"><span class="annottext">oldR' :: R
</span><a href="#local-6989586621679112594"><span class="hs-identifier hs-var hs-var">oldR'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">R
</span><a href="#local-6989586621679112589"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-447"></span><span>          </span><span id="local-6989586621679112595"><span class="annot"><span class="annottext">oldS' :: S
</span><a href="#local-6989586621679112595"><span class="hs-identifier hs-var hs-var">oldS'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679112591"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-448"></span><span>          </span><span id="local-6989586621679112596"><span class="annot"><span class="annottext">oldT' :: T
</span><a href="#local-6989586621679112596"><span class="hs-identifier hs-var hs-var">oldT'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">T
</span><a href="#local-6989586621679112593"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-449"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#R%27"><span class="hs-identifier hs-type">R'</span></a></span><span> </span><span id="local-6989586621679112597"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112597"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112598"><span class="annot"><span class="annottext">R
</span><a href="#local-6989586621679112598"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">R
</span><a href="#local-6989586621679112588"><span class="hs-identifier hs-var">oldR</span></a></span><span> </span><span class="annot"><span class="annottext">R -&gt; R -&gt; (R, R)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`quotRem`</span></span><span> </span><span class="annot"><span class="annottext">R
</span><a href="#local-6989586621679112589"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-450"></span><span>          </span><span id="local-6989586621679112599"><span class="annot"><span class="annottext">s' :: S
</span><a href="#local-6989586621679112599"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679112590"><span class="hs-identifier hs-var">oldS</span></a></span><span> </span><span class="annot"><span class="annottext">S -&gt; S -&gt; S
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; S
</span><a href="Numeric.Data.ModP.Internal.Primality.html#S%27"><span class="hs-identifier hs-var">S'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112597"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">S -&gt; S -&gt; S
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679112591"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-451"></span><span>          </span><span id="local-6989586621679112600"><span class="annot"><span class="annottext">t' :: T
</span><a href="#local-6989586621679112600"><span class="hs-identifier hs-var hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">T
</span><a href="#local-6989586621679112592"><span class="hs-identifier hs-var">oldT</span></a></span><span> </span><span class="annot"><span class="annottext">T -&gt; T -&gt; T
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; T
</span><a href="Numeric.Data.ModP.Internal.Primality.html#T%27"><span class="hs-identifier hs-var">T'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679112597"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">T -&gt; T -&gt; T
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">T
</span><a href="#local-6989586621679112593"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-452"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">R -&gt; R -&gt; S -&gt; S -&gt; T -&gt; T -&gt; Bezout
</span><a href="#local-6989586621679112571"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">R
</span><a href="#local-6989586621679112594"><span class="hs-identifier hs-var">oldR'</span></a></span><span> </span><span class="annot"><span class="annottext">R
</span><a href="#local-6989586621679112598"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679112595"><span class="hs-identifier hs-var">oldS'</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679112599"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">T
</span><a href="#local-6989586621679112596"><span class="hs-identifier hs-var">oldT'</span></a></span><span> </span><span class="annot"><span class="annottext">T
</span><a href="#local-6989586621679112600"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-453"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#eec"><span class="hs-pragma hs-type">eec</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="annot"><span class="hs-comment">-- | @since 0.1</span></span><span>
</span><span id="line-456"></span><span class="annot"><a href="Numeric.Data.ModP.Internal.Primality.html#errMsg"><span class="hs-identifier hs-type">errMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-457"></span><span id="errMsg"><span class="annot"><span class="annottext">errMsg :: ShowS
</span><a href="Numeric.Data.ModP.Internal.Primality.html#errMsg"><span class="hs-identifier hs-var hs-var">errMsg</span></a></span></span><span> </span><span id="local-6989586621679112601"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679112601"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-458"></span><span>  </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-459"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Numeric.Data.ModP: &quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-460"></span><span>      </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679112601"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-462"></span></pre></body></html>